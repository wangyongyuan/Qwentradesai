# AI å¤šæ™ºèƒ½ä½“äº¤æ˜“åˆ†æç³»ç»Ÿè®¾è®¡æ–‡æ¡£ v4

## ä¸€ã€ç³»ç»Ÿæ¦‚è¿°

æœ¬ç³»ç»Ÿé‡‡ç”¨å¤šæ™ºèƒ½ä½“åä½œæ¶æ„ï¼Œé€šè¿‡å¸‚åœºä¿¡å·æ£€æµ‹å™¨è§¦å‘åï¼Œç”±4ä¸ªä¸“ä¸šAIåˆ†æå¸ˆå¹¶è¡Œåˆ†æï¼Œæœ€ç»ˆç”±é¦–å¸­äº¤æ˜“å®˜ç»¼åˆå†³ç­–ã€‚åŒæ—¶é…å¤‡ç‹¬ç«‹çš„æŒä»“ç®¡ç†AIï¼Œè´Ÿè´£åŠ¨æ€è°ƒæ•´ä»“ä½ã€‚

### æ ¸å¿ƒæ¶æ„

```
å¸‚åœºä¿¡å·æ£€æµ‹å™¨
       â†“ (ä¿¡å·è§¦å‘)
   â”Œâ”€â”€â”€â”´â”€â”€â”€â”
   â†“       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         å¹¶è¡Œåˆ†æå±‚ (qwen3-max)        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æŠ€æœ¯åˆ†æå¸ˆ â”‚ æƒ…ç»ªåˆ†æå¸ˆ â”‚   é£æ§å®˜    â”‚
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â†“
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚ é¦–å¸­äº¤æ˜“å®˜ (Claude-Sonnet) â”‚
      â”‚     ç»¼åˆå†³ç­– & å¼€ä»“å»ºè®®    â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   æŒä»“ç®¡ç†AI (Claude-Sonnet)         â”‚
â”‚   ç‹¬ç«‹è¿è¡Œï¼Œç›‘æ§å¹¶è°ƒæ•´ç°æœ‰æŒä»“        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ•°æ®å¤„ç†åŸåˆ™

**ç²¾ç®€æ•°æ®æ ¼å¼**ï¼šæ‰€æœ‰è¾“å…¥ç»™AIçš„æ•°æ®é‡‡ç”¨ã€Œå…³é”®æ•°å€¼ + çŠ¶æ€æ ‡ç­¾ã€çš„ç²¾ç®€æ ¼å¼ï¼Œåˆ é™¤åˆ¤æ–­åŸºå‡†è¡¨ï¼ˆAIå·²çŸ¥è¿™äº›æ ‡å‡†ï¼‰å’Œå†å²å¯¹æ¯”æ•°æ®ï¼ˆç»™ç®€å•æ ‡ç­¾å³å¯ï¼‰ã€‚

---

## äºŒã€æ™ºèƒ½ä½“è¯¦ç»†è®¾è®¡

### 2.1 æŠ€æœ¯åˆ†æå¸ˆ (Technical Analyst)

**æ¨¡å‹**: qwen3-max

**èŒè´£**: åŸºäºå¤šå‘¨æœŸKçº¿å’ŒæŠ€æœ¯æŒ‡æ ‡è¿›è¡Œå¸‚åœºç»“æ„åˆ†æ

**é¢„å¤„ç†åçš„è¾“å…¥æ ¼å¼**:

```
## æŠ€æœ¯åˆ†ææ•°æ®æ‘˜è¦
ç”Ÿæˆæ—¶é—´: 2024-01-15 10:30:00 UTC
äº¤æ˜“å¯¹: BTCUSDT
å½“å‰ä»·æ ¼: 42,850 USDT

---

### ä¸€ã€å¤šå‘¨æœŸè¶‹åŠ¿æ€»è§ˆ

| å‘¨æœŸ | è¶‹åŠ¿æ–¹å‘ | EMAæ’åˆ— | ä»·æ ¼ä½ç½® | MACD | RSI |
|------|----------|---------|----------|------|-----|
| 15åˆ†é’Ÿ | ğŸ“ˆ ä¸Šæ¶¨ | å¤šå¤´(9>21>55) | EMA9ä¸Šæ–¹ | é‡‘å‰ï¼ŒæŸ±çŠ¶å›¾æ‰©å¼  | 62.5 |
| 4å°æ—¶ | ğŸ“ˆ ä¸Šæ¶¨ | å¤šå¤´(9>21) | EMA9ä¸Šæ–¹ | é‡‘å‰ï¼ŒæŸ±çŠ¶å›¾æ‰©å¼  | 58.5 |
| æ—¥çº¿ | ğŸ“ˆ ä¸Šæ¶¨ | å¤šå¤´(9>21) | EMA9ä¸Šæ–¹ | - | - |

**å¤šå‘¨æœŸå…±æŒ¯**: âœ… ä¸‰å‘¨æœŸåŒå‘çœ‹æ¶¨

---

### äºŒã€15åˆ†é’Ÿçº§åˆ«è¯¦æƒ…

#### EMAç³»ç»Ÿ
- EMA9: 42,820 | EMA21: 42,650 | EMA55: 42,380
- æ’åˆ—: âœ… å¤šå¤´æ’åˆ—

#### åŠ¨èƒ½æŒ‡æ ‡
- RSI(7): 62.5 (ä¸­æ€§åå¼º)
- MACD: é‡‘å‰ï¼ŒæŸ±çŠ¶å›¾ +27.3 (æ‰©å¼ ä¸­)
- ADX(14): 25.5 (æœ‰æ•ˆè¶‹åŠ¿)

#### æ³¢åŠ¨æ€§
- å¸ƒæ—å¸¦: ä¸Šè½¨ 43,450 | ä¸­è½¨ 42,680 | ä¸‹è½¨ 41,910
- ä»·æ ¼ä½ç½®: ä¸­è½¨ä¸ä¸Šè½¨ä¹‹é—´
- ATR(14): 385 USDT (0.90%ï¼Œæ­£å¸¸)

#### é‡ä»·
- OBV: ä¸Šå‡ï¼Œé‡ä»·é…åˆ âœ…

---

### ä¸‰ã€4å°æ—¶çº§åˆ«è¯¦æƒ…

#### EMAç³»ç»Ÿ
- EMA9: 42,580 | EMA21: 42,150
- æ’åˆ—: âœ… å¤šå¤´æ’åˆ—

#### åŠ¨èƒ½æŒ‡æ ‡
- RSI(14): 58.5 (å¥åº·)
- MACD: é‡‘å‰ï¼ŒæŸ±çŠ¶å›¾ +186 (æ‰©å¼ ä¸­)

#### å¸ƒæ—å¸¦
- ä¸Šè½¨: 44,200 | ä¸­è½¨: 42,450 | ä¸‹è½¨: 40,700

#### OBV
- è¶‹åŠ¿: ä¸Šå‡ âœ…

---

### å››ã€æ—¥çº¿çº§åˆ«è¯¦æƒ…

- EMA9: 42,100 | EMA21: 41,200
- æ’åˆ—: âœ… å¤šå¤´æ’åˆ—
- ä»·æ ¼ä½ç½®: EMA9ä¸Šæ–¹ +1.78%

---

### äº”ã€å…³é”®ä»·ä½

#### æ”¯æ’‘ä½
| ä»·ä½ | ç±»å‹ |
|------|------|
| 42,650 | 15m EMA21 |
| 42,150 | 4h EMA21 |
| 41,200 | æ—¥çº¿EMA21 |

#### é˜»åŠ›ä½
| ä»·ä½ | ç±»å‹ |
|------|------|
| 43,450 | 15m BBä¸Šè½¨ |
| 44,200 | 4h BBä¸Šè½¨ |
| 45,000 | å‰é«˜ |

---

è¯·åŸºäºä»¥ä¸Šæ•°æ®è¿›è¡ŒæŠ€æœ¯åˆ†æã€‚
```
4. å…³é”®å¤±æ•ˆä»·ä½ï¼ˆè·Œç ´åˆ™çœ‹æ³•å¤±æ•ˆï¼‰ï¼Ÿ
```

**è¾“å‡ºç»“æ„**:
```json
{
  "analyst": "technical",
  "timestamp": "2024-01-15T10:30:00Z",
  "symbol": "BTCUSDT",
  "current_price": 42850,
  "trend_assessment": {
    "timeframe_scores": {
      "daily": 50,
      "h4": 30,
      "m15": 20,
      "total": 100
    },
    "primary_trend": "bullish",
    "trend_strength": "strong"
  },
  "momentum": {
    "rsi_status": "healthy",
    "macd_status": "bullish_expanding",
    "divergence": "none"
  },
  "volatility": {
    "regime": "normal",
    "atr_percent": 0.90
  },
  "volume": {
    "obv_trend": "rising",
    "price_volume_confirmation": true
  },
  "key_levels": {
    "supports": [42650, 42150],
    "resistances": [43450, 44200],
    "invalidation": 42150
  },
  "recommendation": {
    "direction": "long",
    "confidence": 0.80,
    "entry_zone": [42700, 42900],
    "invalidation_price": 42150,
    "reasoning": "æ—¥çº¿å¤šå¤´(+50)+4å°æ—¶é‡‘å‰(+30)+15åˆ†é’Ÿä¼ç¨³(+20)=æ€»åˆ†100ï¼Œå¼ºçƒˆçœ‹å¤šã€‚å»ºè®®åœ¨42700-42900åŒºé—´åšå¤šï¼Œè·Œç ´42150åˆ™çœ‹æ³•å¤±æ•ˆã€‚"
  }
}
```

**Promptæ¨¡æ¿**:
```
## è§’è‰²è®¾å®š

ä½ æ˜¯ä¸€ä½æ‹¥æœ‰10å¹´åŠ å¯†è´§å¸äº¤æ˜“ç»éªŒçš„èµ„æ·±æŠ€æœ¯åˆ†æå¸ˆï¼Œä¸“æ³¨äºå¤šå‘¨æœŸè¶‹åŠ¿åˆ†æã€‚

### ä½ çš„åˆ†ææ¡†æ¶
- **æ—¥çº¿(1D)**: çœ‹å¤§æ–¹å‘ï¼Œç¡®å®šä¸»è¶‹åŠ¿æ˜¯å¤šè¿˜æ˜¯ç©ºï¼ˆæƒé‡: 50%ï¼‰
- **4å°æ—¶(4H)**: çœ‹ç»“æ„ï¼Œæ‰¾è¶‹åŠ¿ä¸­çš„å›è°ƒ/åå¼¹ä½ç½®ï¼ˆæƒé‡: 30%ï¼‰
- **15åˆ†é’Ÿ(15M)**: æ‰¾ç²¾ç¡®å…¥åœºç‚¹ï¼Œä¼˜åŒ–é£é™©å›æŠ¥æ¯”ï¼ˆæƒé‡: 20%ï¼‰

### å¤šå‘¨æœŸæƒé‡æ‰“åˆ†
ä¸è¦æ±‚ä¸‰å‘¨æœŸ"å…¨ç¥¨é€šè¿‡"ï¼Œä½¿ç”¨åŠ æƒæ‰“åˆ†ï¼š
- æ—¥çº¿çœ‹å¤š +50åˆ†ï¼Œçœ‹ç©º -50åˆ†ï¼Œéœ‡è¡ 0åˆ†
- 4å°æ—¶çœ‹å¤š +30åˆ†ï¼Œçœ‹ç©º -30åˆ†ï¼Œéœ‡è¡ 0åˆ†
- 15åˆ†é’Ÿçœ‹å¤š +20åˆ†ï¼Œçœ‹ç©º -20åˆ†ï¼Œéœ‡è¡ 0åˆ†
- æ€»åˆ† > +50ï¼šå¯ä»¥åšå¤š
- æ€»åˆ† < -50ï¼šå¯ä»¥åšç©º
- -50 ~ +50ï¼šè§‚æœ›æˆ–è½»ä»“

**ç¤ºä¾‹**ï¼šæ—¥çº¿å¤š(+50) + 4å°æ—¶å¤š(+30) + 15åˆ†é’Ÿéœ‡è¡(0) = +80åˆ† â†’ å¯ä»¥åšå¤š

### ä½ çš„ä¸“ä¸šèƒŒæ™¯
- ç²¾é€šé“æ°ç†è®ºã€å¨ç§‘å¤«æ–¹æ³•ï¼Œç†è§£å¸‚åœºç»“æ„
- æ“…é•¿EMAå‡çº¿ç³»ç»Ÿï¼ˆ9/21/55ï¼‰ï¼Œç”¨å‡çº¿æ’åˆ—åˆ¤æ–­è¶‹åŠ¿
- é‡è§†MACDåŠ¨èƒ½å˜åŒ–ï¼Œé‡‘å‰æ­»å‰æ˜¯é‡è¦çš„ç»“æ„ä¿¡å·
- ç”¨ADXç¡®è®¤è¶‹åŠ¿æœ‰æ•ˆæ€§ï¼Œç”¨RSIåˆ¤æ–­è¶…ä¹°è¶…å–
- ç›¸ä¿¡é‡ä»·é…åˆï¼ŒOBVæ˜¯éªŒè¯è¶‹åŠ¿çš„é‡è¦å·¥å…·

### ä½ çš„åˆ†æåŸåˆ™
- **é¡ºåŠ¿äº¤æ˜“**: ä¸é€†ç€æ—¥çº¿è¶‹åŠ¿åšå•
- **æƒé‡å…±æŒ¯**: ä½¿ç”¨åŠ æƒæ‰“åˆ†ï¼Œä¸è¦æ±‚å…¨éƒ¨å…±æŒ¯
- **ç»“æ„ä¼˜å…ˆ**: 4å°æ—¶çº§åˆ«çš„MACDé‡‘å‰/æ­»å‰æ˜¯å…³é”®ç»“æ„ä¿¡å·
- **ç²¾ç¡®å…¥åœº**: ç”¨15åˆ†é’Ÿæ‰¾å¥½çš„å…¥åœºç‚¹ä½ï¼Œæé«˜é£é™©å›æŠ¥æ¯”
- **è¶‹åŠ¿ç¡®è®¤**: ADX>25æ‰è®¤ä¸ºè¶‹åŠ¿æœ‰æ•ˆï¼Œå¦åˆ™æ˜¯éœ‡è¡å¸‚

---

## åˆ†ææ•°æ®

{technical_data_summary}

---

## åˆ†æä»»åŠ¡

è¯·åŸºäºä»¥ä¸Šæ•°æ®ï¼Œå®Œæˆå¤šå‘¨æœŸæŠ€æœ¯åˆ†æï¼š

### 1. æ—¥çº¿çº§åˆ«ï¼ˆå®šæ–¹å‘ï¼Œæƒé‡50%ï¼‰
- å½“å‰å¤„äºä»€ä¹ˆè¶‹åŠ¿ï¼Ÿä¸Šæ¶¨/ä¸‹è·Œ/éœ‡è¡ï¼Ÿ
- EMAæ’åˆ—æ˜¯å¤šå¤´è¿˜æ˜¯ç©ºå¤´ï¼Ÿ
- æ—¥çº¿å¾—åˆ†ï¼š+50 / 0 / -50

### 2. 4å°æ—¶çº§åˆ«ï¼ˆæ‰¾ç»“æ„ï¼Œæƒé‡30%ï¼‰
- MACDæ˜¯é‡‘å‰è¿˜æ˜¯æ­»å‰ï¼ŸæŸ±çŠ¶å›¾æ‰©å¼ è¿˜æ˜¯æ”¶ç¼©ï¼Ÿ
- å½“å‰æ˜¯è¶‹åŠ¿å»¶ç»­ã€å›è°ƒã€è¿˜æ˜¯åè½¬ï¼Ÿ
- 4å°æ—¶å¾—åˆ†ï¼š+30 / 0 / -30

### 3. 15åˆ†é’Ÿçº§åˆ«ï¼ˆæ‰¾å…¥åœºï¼Œæƒé‡20%ï¼‰
- çŸ­æœŸè¶‹åŠ¿ä¸4å°æ—¶æ˜¯å¦å…±æŒ¯ï¼Ÿ
- RSIçŠ¶æ€å¦‚ä½•ï¼Ÿæ˜¯å¦è¶…ä¹°è¶…å–ï¼Ÿ
- 15åˆ†é’Ÿå¾—åˆ†ï¼š+20 / 0 / -20

### 4. ç»¼åˆæ‰“åˆ†
- æ€»åˆ† = æ—¥çº¿å¾—åˆ† + 4å°æ—¶å¾—åˆ† + 15åˆ†é’Ÿå¾—åˆ†
- æ ¹æ®æ€»åˆ†åˆ¤æ–­æ–¹å‘å’Œç½®ä¿¡åº¦

### 5. äº¤æ˜“å»ºè®®
- æ–¹å‘ï¼šlong / short / neutral
- ç½®ä¿¡åº¦ï¼šåŸºäºæ€»åˆ†è®¡ç®—ï¼ˆå¦‚+80åˆ†â†’0.8ç½®ä¿¡åº¦ï¼‰
- å…¥åœºåŒºé—´
- å¤±æ•ˆä»·ä½

---

## è¾“å‡ºè¦æ±‚

è¯·ä»¥JSONæ ¼å¼è¾“å‡ºï¼ŒåŒ…å«ä»¥ä¸‹å­—æ®µï¼š
- trend_assessment: è¶‹åŠ¿è¯„ä¼°ï¼ˆåŒ…å« timeframe_scores: {daily, h4, m15, total}ï¼‰
- momentum: åŠ¨èƒ½çŠ¶æ€ï¼ˆrsi_status, macd_status, divergenceï¼‰
- volatility: æ³¢åŠ¨æ€§ï¼ˆregime, atr_percentï¼‰
- volume: é‡èƒ½ï¼ˆobv_trend, price_volume_confirmationï¼‰
- key_levels: å…³é”®ä»·ä½ï¼ˆsupports, resistances, invalidationï¼‰
- recommendation: å»ºè®®ï¼ˆdirection, confidence, entry_zone, invalidation_price, reasoningï¼‰

reasoningä¸­è¦ä½“ç°å¤šå‘¨æœŸåˆ†æçš„é€»è¾‘ï¼šæ—¥çº¿å®šæ–¹å‘ â†’ 4å°æ—¶æ‰¾ç»“æ„ â†’ 15åˆ†é’Ÿæ‰¾å…¥åœºã€‚
```

---

### 2.2 æƒ…ç»ªåˆ†æå¸ˆ (Sentiment Analyst)

**æ¨¡å‹**: qwen3-max

**èŒè´£**: åˆ†æå¸‚åœºæƒ…ç»ªã€èµ„é‡‘æµå‘ã€ä»“ä½åˆ†å¸ƒ

**é¢„å¤„ç†åçš„è¾“å…¥æ ¼å¼**:

```
## å¸‚åœºæƒ…ç»ªæ•°æ®æ‘˜è¦
ç”Ÿæˆæ—¶é—´: 2024-01-15 10:30:00 UTC
äº¤æ˜“å¯¹: BTCUSDT

---

### ä¸€ã€ææƒ§è´ªå©ªæŒ‡æ•°

- å½“å‰å€¼: 72 (è´ªå©ª)
- æ˜¨æ—¥: 68
- è¶‹åŠ¿: ğŸ“ˆ æƒ…ç»ªå‡æ¸©ä¸­
- è·ç¦»æç«¯: è¿˜å·®8ç‚¹åˆ°æåº¦è´ªå©ªåŒº(80)
- â±ï¸ æ•°æ®å»¶è¿Ÿ: å®æ—¶ | æƒé‡: é«˜

---

### äºŒã€èµ„é‡‘è´¹ç‡

- å½“å‰: 0.0125% (åé«˜)
- è¶‹åŠ¿: ğŸ“ˆ è¿ç»­5æœŸä¸Šå‡
- å¹´åŒ–æˆæœ¬: 45.6%
- çŠ¶æ€: âš ï¸ å¤šå¤´ç•¥æ‹¥æŒ¤
- â±ï¸ æ•°æ®å»¶è¿Ÿ: å®æ—¶ | æƒé‡: é«˜

---

### ä¸‰ã€æŒä»“é‡ (Open Interest)

- å½“å‰OI: 125äº¿ç¾å…ƒ
- 24hå˜åŒ–: +5.2%
- ä»·æ ¼24hå˜åŒ–: +2.1%
- è§£è¯»: âœ… ä»·æ¶¨+OIæ¶¨ = æ–°å¤šå…¥åœº
- â±ï¸ æ•°æ®å»¶è¿Ÿ: å®æ—¶ | æƒé‡: é«˜

---

### å››ã€å¤šç©ºæ¯”

- å½“å‰: 1.35 (åå¤š)
- å¤šå¤´å æ¯”: 57.5%
- ç©ºå¤´å æ¯”: 42.5%
- è¶‹åŠ¿: ğŸ“ˆ å¤šå¤´æ¯”ä¾‹å¢åŠ ä¸­
- â±ï¸ æ•°æ®å»¶è¿Ÿ: å®æ—¶ | æƒé‡: ä¸­ï¼ˆæ•£æˆ·æŒ‡æ ‡ï¼Œå¸¸ä¸ºåå‘ï¼‰

---

### äº”ã€ETFèµ„é‡‘æµ (BTC)

- æ˜¨æ—¥å‡€æµ: +1.25äº¿ç¾å…ƒ (T+1æ•°æ®)
- è¿ç»­æµå…¥: 5å¤©
- æœ¬å‘¨ç´¯è®¡: +5.8äº¿ç¾å…ƒ
- çŠ¶æ€: âœ… æœºæ„æŒç»­ä¹°å…¥
- â±ï¸ æ•°æ®å»¶è¿Ÿ: T+1 | æƒé‡: ä¸­ï¼ˆå»¶è¿Ÿæ•°æ®ï¼Œå‚è€ƒè¶‹åŠ¿è€Œéå½“æ—¥ï¼‰

---

### å…­ã€å¤§å•åŠ¨å‘

- å¤§å•ä¹°å–æ¯”: 1.18 (ä¹°ç›˜å ä¼˜)
- çŠ¶æ€: ğŸ“ˆ åå‘ä¹°å…¥
- â±ï¸ æ•°æ®å»¶è¿Ÿ: å®æ—¶ | æƒé‡: ä¸­

---

**æ•°æ®æƒé‡è¯´æ˜**ï¼š
- é«˜æƒé‡ï¼ˆå®æ—¶ï¼‰: æè´ªæŒ‡æ•°ã€èµ„é‡‘è´¹ç‡ã€OI
- ä¸­æƒé‡ï¼ˆæœ‰å»¶è¿Ÿæˆ–å¯é æ€§ä¸€èˆ¬ï¼‰: ETFèµ„é‡‘æµ(T+1)ã€å¤šç©ºæ¯”ã€å¤§å•

è¯·åŸºäºä»¥ä¸Šæ•°æ®è¿›è¡Œæƒ…ç»ªé¢åˆ†æï¼Œæ³¨æ„æ•°æ®å»¶è¿Ÿå¯¹åˆ¤æ–­çš„å½±å“ã€‚
```

#### æœ€è¿‘5æ—¥æ˜ç»†
| æ—¥æœŸ | å‡€æµ | ç±»å‹ |
|------|------|------|
| 01-15 | +1.25äº¿ | æµå…¥ |
è¯·åŸºäºä»¥ä¸Šæ•°æ®è¿›è¡Œæƒ…ç»ªé¢åˆ†æã€‚
```

**è¾“å‡ºç»“æ„**:
```json
{
  "analyst": "sentiment",
  "timestamp": "2024-01-15T10:30:00Z",
  "symbol": "BTCUSDT",
  
  "overall_sentiment": {
    "status": "bullish",
    "intensity": "moderate",
    "extreme_signal": false
  },
  
  "indicators": {
    "fear_greed": 72,
    "funding_rate": 0.0125,
    "oi_change_24h": 5.2,
    "long_short_ratio": 1.35,
    "etf_flow_today": 125000000
  },
  
  "contrarian_alerts": [],
  
  "recommendation": {
    "direction": "bullish",
    "confidence": 0.70,
    "supporting": ["ETFè¿ç»­5æ—¥å‡€æµå…¥", "OIå¢åŠ é…åˆä»·æ ¼ä¸Šæ¶¨"],
    "risks": ["èµ„é‡‘è´¹ç‡åé«˜", "æè´ªæŒ‡æ•°æ¥è¿‘è¿‡çƒ­åŒº"],
    "reasoning": "æƒ…ç»ªé¢æ•´ä½“åå¤šä½†æœªè¾¾æç«¯ã€‚ETFæŒç»­æµå…¥æ˜¯æœ€å¼ºæ”¯æ’‘ä¿¡å·ï¼Œä½†éœ€è­¦æƒ•èµ„é‡‘è´¹ç‡åé«˜ã€‚"
  }
}
```

**Promptæ¨¡æ¿**:
```
## è§’è‰²è®¾å®š

ä½ æ˜¯ä¸€ä½ä¸“æ³¨äºåŠ å¯†è´§å¸å¸‚åœºçš„èµ„æ·±æƒ…ç»ªåˆ†æå¸ˆï¼Œåœ¨å¯¹å†²åŸºé‡‘å·¥ä½œäº†8å¹´ã€‚

ä½ çš„ä¸“ä¸šèƒŒæ™¯ï¼š
- æ·±è°™å¸‚åœºå¿ƒç†å­¦ï¼Œç†è§£"å¸‚åœºå…ˆç”Ÿ"çš„æƒ…ç»ªæ³¢åŠ¨è§„å¾‹
- ç²¾é€šèµ„é‡‘æµå‘åˆ†æï¼Œèƒ½ä»èµ„é‡‘è´¹ç‡ã€OIå˜åŒ–ä¸­è¯»å‡ºä¸»åŠ›æ„å›¾
- å¯¹æ•£æˆ·è¡Œä¸ºæœ‰æ·±åˆ»æ´å¯Ÿï¼ŒçŸ¥é“ä»€ä¹ˆæ—¶å€™æ•£æˆ·ä¼šæˆä¸º"åå‘æŒ‡æ ‡"
- é•¿æœŸè·Ÿè¸ªæœºæ„åŠ¨å‘ï¼ŒETFèµ„é‡‘æµæ˜¯ä½ åˆ¤æ–­æœºæ„æ€åº¦çš„é‡è¦ä¾æ®
- ä¿¡å¥‰"åœ¨åˆ«äººææƒ§æ—¶è´ªå©ªï¼Œåœ¨åˆ«äººè´ªå©ªæ—¶ææƒ§"çš„é€†å‘æ€ç»´

ä½ çš„åˆ†æåŸåˆ™ï¼š
- æƒ…ç»ªæŒ‡æ ‡æ˜¯é¢†å…ˆæŒ‡æ ‡ï¼Œå¾€å¾€æ¯”ä»·æ ¼æ›´æ—©åæ˜ è½¬æŠ˜
- æç«¯æƒ…ç»ªæ˜¯æœ€å¯é çš„é€†å‘ä¿¡å·ï¼Œä½†"æç«¯"æœ‰æ˜ç¡®çš„é‡åŒ–æ ‡å‡†
- èµ„é‡‘è´¹ç‡åæ˜ çš„æ˜¯æ æ†äº¤æ˜“è€…çš„æˆæœ¬å’Œæƒ…ç»ª
- æ•£æˆ·å¤šç©ºæ¯”ç»å¸¸æ˜¯åå‘æŒ‡æ ‡ï¼Œå½“æ•£æˆ·ä¸€è‡´çœ‹å¤šæ—¶è¦è­¦æƒ•
- ETFèµ„é‡‘æµä»£è¡¨æœºæ„æ€åº¦ï¼Œæœºæ„çš„é’±æ˜¯"èªæ˜é’±"
- çˆ†ä»“æ•°æ®åæ˜ å¸‚åœºçš„æ æ†æ¸…æ´—ç¨‹åº¦

ä½ çš„åˆ¤æ–­æ ‡å‡†ï¼š
- æè´ªæŒ‡æ•°>80æˆ–<20æ‰ç®—æç«¯
- èµ„é‡‘è´¹ç‡>0.03%æˆ–<-0.03%æ‰ç®—æç«¯
- å¤šç©ºæ¯”>2.0æˆ–<0.7æ‰è€ƒè™‘é€†å‘
- ETFè¿ç»­3å¤©ä»¥ä¸ŠåŒå‘æµåŠ¨æ‰ç®—è¶‹åŠ¿ç¡®è®¤

---

## åˆ†ææ•°æ®

{sentiment_data_summary}

---

## åˆ†æä»»åŠ¡

è¯·åŸºäºä»¥ä¸Šæ•°æ®ï¼Œå®Œæˆæƒ…ç»ªé¢åˆ†æï¼š

1. **æ•´ä½“æƒ…ç»ª**: å½“å‰å¸‚åœºå¤„äºä»€ä¹ˆæƒ…ç»ªçŠ¶æ€ï¼Ÿæ˜¯ææƒ§ã€ä¸­æ€§è¿˜æ˜¯è´ªå©ªï¼Ÿ
2. **èµ„é‡‘åŠ¨å‘**: èµ„é‡‘è´¹ç‡å’ŒOIå˜åŒ–è¯´æ˜äº†ä»€ä¹ˆï¼Ÿ
3. **æœºæ„æ€åº¦**: ETFèµ„é‡‘æµåæ˜ æœºæ„åœ¨åšä»€ä¹ˆï¼Ÿ
4. **æ•£æˆ·ä»“ä½**: æ•£æˆ·çš„ä»“ä½åˆ†å¸ƒæ˜¯å¦æ„æˆåå‘ä¿¡å·ï¼Ÿ
5. **é€†å‘ä¿¡å·**: æ˜¯å¦æœ‰ä»»ä½•æŒ‡æ ‡è§¦å‘äº†æç«¯å€¼ï¼Œéœ€è¦é€†å‘æ€è€ƒï¼Ÿ
6. **é£é™©å› ç´ **: å½“å‰æƒ…ç»ªé¢æœ‰å“ªäº›éœ€è¦è­¦æƒ•çš„é£é™©ï¼Ÿ

---

## è¾“å‡ºè¦æ±‚

è¯·ä»¥JSONæ ¼å¼è¾“å‡ºï¼ŒåŒ…å«ä»¥ä¸‹å­—æ®µï¼š
- overall_sentiment: æ•´ä½“æƒ…ç»ªï¼ˆstatusã€intensityã€extreme_signalï¼‰
- indicators: å„æŒ‡æ ‡æ•°å€¼ï¼ˆfear_greedã€funding_rateã€oi_change_24hã€long_short_ratioã€etf_flow_todayï¼‰
- contrarian_alerts: é€†å‘ä¿¡å·åˆ—è¡¨ï¼ˆå¦‚æœ‰æç«¯ä¿¡å·åˆ™å¡«å…¥ï¼Œå¦åˆ™ä¸ºç©ºæ•°ç»„ï¼‰
- recommendation: å»ºè®®ï¼ˆdirectionã€confidenceã€supportingã€risksã€reasoningï¼‰
```

---

### 2.3 é£æ§å®˜ (Risk Manager)

**æ¨¡å‹**: qwen3-max

**èŒè´£**: è¯„ä¼°é£é™©æ•å£ã€å¸‚åœºæ³¢åŠ¨æ€§ã€ä»“ä½å»ºè®®

**é¢„å¤„ç†åçš„è¾“å…¥æ ¼å¼**:

```
## é£é™©è¯„ä¼°æ•°æ®æ‘˜è¦
ç”Ÿæˆæ—¶é—´: 2024-01-15 10:30:00 UTC
äº¤æ˜“å¯¹: BTCUSDT
å½“å‰ä»·æ ¼: 42,850 USDT

---

### ä¸€ã€æ³¢åŠ¨æ€§

- ATR(14): 385 USDT (0.90%)
- çŠ¶æ€: æ­£å¸¸
- å¸ƒæ—å¸¦å®½: 3.6%

---

### äºŒã€æµåŠ¨æ€§

- æ€»ç›˜å£æ·±åº¦: 1,000ä¸‡ USDT
- ä¹°å–æ¯”: 1.08
- çŠ¶æ€: âœ… ä¼˜ç§€

---

### ä¸‰ã€æ æ†é£é™©

- OI: 125äº¿ç¾å…ƒï¼Œ24h +5.2%
- èµ„é‡‘è´¹ç‡: 0.0125% (åé«˜)
- 24hæ€»çˆ†ä»“: 7,300ä¸‡ (ä¸­ç­‰)
- çŠ¶æ€: âš ï¸ ä¸­ç­‰é£é™©

---

### å››ã€è´¦æˆ·ä¿¡æ¯

- å¯ç”¨ä½™é¢: 10,000 USDT
- å•ç¬”æœ€å¤§é£é™©: 2% = 200 USDT
- ATRæ­¢æŸå‚è€ƒ: 1.5x ATR = 1.35%

---

### äº”ã€æœ€è¿‘7å¤©äº¤æ˜“è®°å½•

| æ—¶é—´ | æ–¹å‘ | æ æ† | ä»“ä½æ”¶ç›Š | æ‰‹ç»­è´¹ | èµ„é‡‘è´¹ç‡ | æœ€ç»ˆç›ˆäº | ç»“æœ |
|------|------|------|----------|--------|----------|----------|------|
| 01-14 18:30 | Long | 3x | +85.2 | -4.2 | -6.5 | +74.5 | ç›ˆåˆ© |
| 01-14 02:15 | Long | 2x | +42.8 | -2.8 | -3.2 | +36.8 | ç›ˆåˆ© |
| 01-13 14:20 | Short | 3x | -38.5 | -3.5 | +2.1 | -39.9 | äºæŸ |
| 01-12 22:45 | Long | 3x | +126.3 | -5.2 | -12.8 | +108.3 | ç›ˆåˆ© |
| 01-12 08:10 | Long | 2x | +28.6 | -2.1 | -1.5 | +25.0 | ç›ˆåˆ© |
| 01-11 16:30 | Long | 2x | -52.4 | -2.8 | -4.2 | -59.4 | äºæŸ |
| 01-10 10:00 | Short | 2x | +35.2 | -2.4 | +1.8 | +34.6 | ç›ˆåˆ© |

**7å¤©ç»Ÿè®¡**:
- äº¤æ˜“æ¬¡æ•°: 7ç¬”
- èƒœç‡: 71% (5ç›ˆ2äº)
- æ€»ç›ˆäº: +179.9 USDT
- æ€»æ‰‹ç»­è´¹: -23.0 USDT
- æ€»èµ„é‡‘è´¹ç‡: -24.3 USDT
- å‡€æ”¶ç›Š: +132.6 USDT

---

è¯·è¿›è¡Œé£é™©è¯„ä¼°ï¼Œç»™å‡ºä»“ä½å’Œæ­¢æŸå»ºè®®ã€‚
```

**è¾“å‡ºç»“æ„**:
```json
{
  "analyst": "risk",
  "timestamp": "2024-01-15T10:30:00Z",
  "symbol": "BTCUSDT",
  "current_price": 42850,
  
  "assessment": {
    "risk_score": 0.35,
    "risk_level": "moderate",
    "position_allowed": true,
    "volatility": "normal",
    "liquidity": "excellent"
  },
  
  "sizing": {
    "leverage": 2,
    "position_pct": 5,
    "stop_loss_price": 42271,
    "stop_loss_pct": 1.35
  },
  
  "warnings": [
    "èµ„é‡‘è´¹ç‡åé«˜ï¼Œæ§åˆ¶æŒä»“æ—¶é—´",
    "OIä¸Šå‡ï¼Œæ³¨æ„æ æ†é£é™©"
  ],
  
  "reasoning": "é£é™©è¯„åˆ†0.35å¯æ¥å—ã€‚æ³¢åŠ¨ç‡æ­£å¸¸ï¼ŒæµåŠ¨æ€§ä¼˜ç§€ã€‚å»ºè®®2å€æ æ†ã€5%ä»“ä½ï¼Œæ­¢æŸ1.35%ã€‚"
}
```

**Promptæ¨¡æ¿**:
```
## è§’è‰²è®¾å®š

ä½ æ˜¯ä¸€ä½åœ¨é¡¶çº§é‡åŒ–å¯¹å†²åŸºé‡‘æ‹…ä»»é¦–å¸­é£æ§å®˜è¶…è¿‡12å¹´çš„èµ„æ·±é£é™©ç®¡ç†ä¸“å®¶ã€‚

ä½ çš„ä¸“ä¸šèƒŒæ™¯ï¼š
- ç»å†è¿‡2008å¹´é‡‘èå±æœºã€2020å¹´312æš´è·Œã€2022å¹´LUNAå´©ç›˜ç­‰å¤šæ¬¡æç«¯è¡Œæƒ…
- æ·±åˆ»ç†è§£"æ´»ä¸‹æ¥æ¯”èµšé’±æ›´é‡è¦"çš„é“ç†
- ç²¾é€šVaRã€CVaRç­‰é£é™©é‡åŒ–æ¨¡å‹ï¼Œä½†æ›´ç›¸ä¿¡å®æˆ˜ç»éªŒ
- å¯¹æ æ†æœ‰å¤©ç„¶çš„è­¦æƒ•ï¼Œè§è¿‡å¤ªå¤šå› ä¸ºæ æ†è¿‡é«˜è€Œçˆ†ä»“çš„æ¡ˆä¾‹
- ä¿¡å¥‰å‡¯åˆ©å…¬å¼ï¼Œä½†å®é™…ä½¿ç”¨æ—¶ä¼šæ›´ä¿å®ˆ

ä½ çš„é£æ§ç†å¿µï¼š
- ä¿æŠ¤æœ¬é‡‘æ˜¯ç¬¬ä¸€ä¼˜å…ˆçº§ï¼Œæ²¡æœ‰æœ¬é‡‘å°±æ²¡æœ‰æœªæ¥
- å•ç¬”äº¤æ˜“é£é™©æ°¸è¿œä¸è¶…è¿‡è´¦æˆ·çš„2%ï¼Œè¿™æ˜¯é“å¾‹
- æ­¢æŸä¸æ˜¯å¤±è´¥ï¼Œè€Œæ˜¯ä¿æŠ¤â€”â€”"æˆªæ–­äºæŸï¼Œè®©åˆ©æ¶¦å¥”è·‘"
- é«˜æ³¢åŠ¨ç¯å¢ƒä¸‹å¿…é¡»é™ä½æ æ†ï¼Œä½æ³¢åŠ¨æ—¶ä¹Ÿä¸è¦è´ªå¿ƒåŠ æ æ†
- æµåŠ¨æ€§æ˜¯éšå½¢æ€æ‰‹ï¼Œå¾ˆå¤šäººæ­»åœ¨"å–ä¸å‡ºå»"ä¸Š
- èµ„é‡‘è´¹ç‡æ˜¯çœŸå®æˆæœ¬ï¼ŒæŒä»“æ—¶é—´è¶Šé•¿æˆæœ¬è¶Šé«˜

ä½ çš„å®¡æ‰¹æ ‡å‡†ï¼š
- ç»¼åˆé£é™©è¯„åˆ† > 0.7 â†’ ç›´æ¥å¦å†³ï¼Œä¸å…è®¸å¼€ä»“
- ç»¼åˆé£é™©è¯„åˆ† 0.5-0.7 â†’ é™ä½ä»“ä½å’Œæ æ†
- ç»¼åˆé£é™©è¯„åˆ† < 0.5 â†’ æ­£å¸¸å®¡æ‰¹
- æ— è®ºå¦‚ä½•ï¼Œæ æ†ä¸è¶…è¿‡5å€ï¼Œä»“ä½ä¸è¶…è¿‡10%

ä½ çš„å£å¤´ç¦…ï¼š
- "èƒ½æ´»åˆ°æ˜å¤©æ¯”ä»Šå¤©èµšå¤šå°‘æ›´é‡è¦"
- "æˆ‘è§è¿‡å¤ªå¤šä¸€å¤œæš´å¯Œç„¶åä¸€å¤œå½’é›¶çš„äºº"
- "æ­¢æŸå•æ˜¯ä½ æœ€å¥½çš„æœ‹å‹"

---

## åˆ†ææ•°æ®

{risk_data_summary}

---

## è¯„ä¼°ä»»åŠ¡

è¯·åŸºäºä»¥ä¸Šæ•°æ®ï¼Œå®Œæˆé£é™©è¯„ä¼°ï¼š

1. **æ³¢åŠ¨æ€§è¯„ä¼°**: å½“å‰æ³¢åŠ¨ç‡æ°´å¹³å¦‚ä½•ï¼Ÿæ˜¯å¦é€‚åˆäº¤æ˜“ï¼Ÿ
2. **æµåŠ¨æ€§è¯„ä¼°**: ç›˜å£æ·±åº¦å¦‚ä½•ï¼Ÿå¤§å•ä¼šæœ‰æ»‘ç‚¹é—®é¢˜å—ï¼Ÿ
3. **æ æ†é£é™©**: å¸‚åœºæ•´ä½“æ æ†æ°´å¹³å¦‚ä½•ï¼Ÿçˆ†ä»“é£é™©å¤§å—ï¼Ÿ
4. **ä»“ä½å»ºè®®**: åŸºäºé£é™©è®¡ç®—ï¼Œå»ºè®®çš„æ æ†å’Œä»“ä½æ˜¯å¤šå°‘ï¼Ÿ
5. **æ­¢æŸè®¾ç½®**: åŸºäºATRï¼Œåˆç†çš„æ­¢æŸä½åœ¨å“ªé‡Œï¼Ÿ
6. **æœ€ç»ˆè£å†³**: æ˜¯å¦å…è®¸å¼€ä»“ï¼Ÿæœ‰ä»€ä¹ˆç‰¹åˆ«è­¦ç¤ºï¼Ÿ

---

## è¾“å‡ºè¦æ±‚

è¯·ä»¥JSONæ ¼å¼è¾“å‡ºï¼ŒåŒ…å«ä»¥ä¸‹å­—æ®µï¼š
- risk_assessment: é£é™©è¯„ä¼°ï¼ˆoverall_scoreã€risk_levelã€position_allowedï¼‰
- volatility: æ³¢åŠ¨æ€§è¯„ä¼°
- liquidity: æµåŠ¨æ€§è¯„ä¼°
- leverage_risk: æ æ†é£é™©
- position_sizing: ä»“ä½å»ºè®®
- stop_loss: æ­¢æŸå»ºè®®
- warnings: è­¦å‘Šåˆ—è¡¨
- recommendation: æœ€ç»ˆå»ºè®®ï¼ˆå¿…é¡»åŒ…å«position_allowedã€suggested_leverageã€suggested_position_pctã€suggested_stop_lossã€reasoningï¼‰

å¦‚æœé£é™©è¿‡é«˜ï¼Œposition_allowedå¿…é¡»ä¸ºfalseï¼Œå¹¶åœ¨reasoningä¸­è§£é‡ŠåŸå› ã€‚
```

---

### 2.4 é¦–å¸­äº¤æ˜“å®˜ (Chief Trading Officer)

**æ¨¡å‹**: Claude-Sonnet-4.5

**èŒè´£**: ç»¼åˆå„åˆ†æå¸ˆæ„è§ï¼Œä»¥ç¬¬ä¸€äººç§°è§†è§’åšå‡ºæœ€ç»ˆå¼€ä»“å†³ç­–

**è¾“å…¥æ ¼å¼**:

```
## é¦–å¸­äº¤æ˜“å®˜å†³ç­–ä¼šè®®

æ—¶é—´: 2024-01-15 10:30:00 UTC
äº¤æ˜“å¯¹: BTCUSDT
å½“å‰ä»·æ ¼: 42,850 USDT

---

### æŠ€æœ¯åˆ†æå¸ˆæŠ¥å‘Š

{technical_report_json}

---

### æƒ…ç»ªåˆ†æå¸ˆæŠ¥å‘Š

{sentiment_report_json}

---

### é£æ§å®˜æŠ¥å‘Š

{risk_report_json}

---

### è´¦æˆ·çŠ¶æ€

- å¯ç”¨ä½™é¢: 10,000 USDT

---

### äº¤æ˜“æˆæœ¬

- æ‰‹ç»­è´¹ç‡: 0.04% (Maker) / 0.06% (Taker)
- å½“å‰èµ„é‡‘è´¹ç‡: 0.0125% (æ¯8å°æ—¶)
- é¢„ä¼°å¼€ä»“æ‰‹ç»­è´¹: çº¦ 0.06% Ã— æŒä»“ä»·å€¼
- èµ„é‡‘è´¹ç‡å¹´åŒ–: 45.6%

**æˆæœ¬æé†’**ï¼š
- åšå¤šéœ€æ”¯ä»˜èµ„é‡‘è´¹ç‡ï¼ˆå½“å‰åé«˜ï¼‰
- æŒä»“24å°æ—¶èµ„é‡‘è´¹ç‡æˆæœ¬çº¦: 0.0375%
- æŒä»“48å°æ—¶èµ„é‡‘è´¹ç‡æˆæœ¬çº¦: 0.075%

---

è¯·åšå‡ºä½ çš„äº¤æ˜“å†³ç­–ï¼Œéœ€è€ƒè™‘äº¤æ˜“æˆæœ¬å¯¹ç›ˆåˆ©çš„å½±å“ã€‚
```

**è¾“å‡ºç»“æ„**:
```json
{
  "analyst": "cto",
  "timestamp": "2024-01-15T10:30:00Z",
  "symbol": "BTCUSDT",
  "current_price": 42850,
  
  "analysis": {
    "market_structure": "æ—¥çº¿çº§åˆ«å¤„äºä¸Šå‡è¶‹åŠ¿ä¸­ï¼Œ4å°æ—¶åˆšå®Œæˆå›è°ƒå¹¶å‡ºç°MACDé‡‘å‰ï¼Œ15åˆ†é’Ÿå½¢æˆæ›´é«˜çš„ä½ç‚¹ç¡®è®¤çŸ­æœŸä¼ç¨³ã€‚ä¸‰ä¸ªå‘¨æœŸå…±æŒ¯å‘ä¸Šï¼Œè¿™æ˜¯æˆ‘æœ€å–œæ¬¢çš„å…¥åœºå½¢æ€ã€‚",
    "sentiment_overview": "æè´ªæŒ‡æ•°72åè´ªå©ªä½†æœªæç«¯ï¼ŒETFè¿ç»­5æ—¥å‡€æµå…¥è¯´æ˜æœºæ„åœ¨ä¹°ï¼Œèµ„é‡‘è´¹ç‡0.0125%åé«˜ä½†å¯æ¥å—ã€‚æƒ…ç»ªé¢æ”¯æŒåšå¤šï¼Œä½†éœ€è­¦æƒ•è¿‡çƒ­é£é™©ã€‚",
    "risk_assessment": "é£æ§è¯„åˆ†0.35å¯æ¥å—ï¼Œæ³¢åŠ¨ç‡æ­£å¸¸ï¼ŒæµåŠ¨æ€§ä¼˜ç§€ã€‚é£æ§å®˜å»ºè®®2å€æ æ†ã€5%ä»“ä½ï¼Œæˆ‘è®¤å¯è¿™ä¸ªä¿å®ˆé…ç½®ã€‚",
    "core_logic": "è¿™æ˜¯ä¸€ç¬”é¡ºåŠ¿äº¤æ˜“ï¼šæ—¥çº¿å®šæ–¹å‘(å¤š)ï¼Œ4å°æ—¶æ‰¾ç»“æ„(é‡‘å‰ç¡®è®¤)ï¼Œ15åˆ†é’Ÿæ‰¾å…¥åœº(å›è°ƒä¼ç¨³)ã€‚ä¸‰å‘¨æœŸå…±æŒ¯+æœºæ„èµ„é‡‘æµå…¥+é£é™©å¯æ§ï¼Œå€¼å¾—ä¸€è¯•ã€‚"
  },
  
  "decision": {
    "action": "open_long",
    "reasoning": "ä¸‰å‘¨æœŸEMAå…±æŒ¯å‘ä¸Šæ˜¯å¼ºä¿¡å·ï¼Œ4å°æ—¶MACDåˆšé‡‘å‰è¯´æ˜åŠ¨èƒ½è½¬å¼ºï¼Œ15åˆ†é’Ÿå›è°ƒåˆ°EMA21è·å¾—æ”¯æ’‘ã€‚æŠ€æœ¯é¢ã€æƒ…ç»ªé¢ã€é£æ§éƒ½åå¤šï¼Œæ²¡æœ‰æ˜æ˜¾çš„åå¯¹ç†ç”±ã€‚è™½ç„¶æè´ªæŒ‡æ•°åé«˜ï¼Œä½†ETFæŒç»­æµå…¥è¯´æ˜æœºæ„è¿˜åœ¨ä¹°ï¼Œè·Ÿç€èªæ˜é’±èµ°ã€‚"
  },
  
  "execution": {
    "entry": {
      "price": 42800,
      "type": "limit",
      "reason": "åœ¨15åˆ†é’ŸEMA21é™„è¿‘æŒ‚å•ï¼Œä¸è¿½é«˜"
    },
    "position": {
      "leverage": 2,
      "size_percent": 5,
      "reason": "æƒ…ç»ªé¢æœ‰éšå¿§ï¼Œé‡‡ç”¨ä¿å®ˆä»“ä½"
    }
  },
  
  "plans": [
    {"take_profit": 43450, "amount": 30, "reason": "15åˆ†é’ŸBBä¸Šè½¨ï¼Œç¬¬ä¸€ç›®æ ‡"},
    {"take_profit": 44200, "amount": 40, "reason": "4å°æ—¶BBä¸Šè½¨ï¼Œä¸»è¦ç›®æ ‡"},
    {"take_profit": 45000, "amount": 30, "reason": "å‰é«˜ï¼Œåšå–æ›´å¤§æ”¶ç›Š"},
    {"stop_loss": 42271, "amount": 100, "reason": "1.5å€ATRï¼Œè·Œç ´åˆ™è¶‹åŠ¿ç ´å"}
  ],
  
  "plans_reasoning": "æ­¢ç›ˆåˆ†ä¸‰æ¡£(30%/40%/30%)å¯¹åº”15åˆ†é’Ÿã€4å°æ—¶ã€æ—¥çº¿çº§åˆ«çš„é˜»åŠ›ä½ï¼Œè®©åˆ©æ¶¦åˆ†æ‰¹è½è¢‹ã€‚æ­¢æŸè®¾åœ¨1.5å€ATRä½ç½®ï¼Œè·Œç ´è¯´æ˜15åˆ†é’Ÿçš„ä¸Šæ¶¨ç»“æ„è¢«ç ´åã€‚é£é™©å›æŠ¥æ¯”çº¦2.4:1ï¼Œç¬¦åˆæ ‡å‡†ã€‚",
  
  "time_frame": {
    "expected_duration": "12-48å°æ—¶",
    "logic": "è¿™æ˜¯4å°æ—¶çº§åˆ«çš„äº¤æ˜“ï¼Œä¸€ä¸ª4å°æ—¶å‘¨æœŸå®Œæ•´èµ°å®Œéœ€è¦1-2å¤©ã€‚èµ„é‡‘è´¹ç‡åé«˜ï¼Œä¸å®œæŒä»“è¶…è¿‡48å°æ—¶ã€‚",
    "max_holding": "48å°æ—¶"
  },
  
  "invalidation": {
    "price": 42150,
    "condition": "è·Œç ´4å°æ—¶EMA21",
    "action": "æ­¢æŸç¦»åœºï¼Œå¼€ä»“é€»è¾‘å¤±æ•ˆ"
  },
  
  "warnings": [
    "æè´ªæŒ‡æ•°72æ¥è¿‘è¿‡çƒ­åŒºï¼Œçªç ´80è¦å‡ä»“",
    "èµ„é‡‘è´¹ç‡0.0125%åé«˜ï¼ŒæŒä»“æˆæœ¬æ¯8å°æ—¶0.0125%",
    "å¦‚æœ48å°æ—¶å†…æ²¡æœ‰åˆ°è¾¾ç¬¬ä¸€æ­¢ç›ˆä½ï¼Œè€ƒè™‘ä¸»åŠ¨å‡ä»“"
  ],
  
  "summary": "è¿™æ˜¯ä¸€ç¬”4å°æ—¶çº§åˆ«çš„é¡ºåŠ¿äº¤æ˜“ï¼Œæ—¥çº¿å¤šå¤´+4å°æ—¶é‡‘å‰+15åˆ†é’Ÿä¼ç¨³æ„æˆå…¥åœºä¾æ®ã€‚ç”¨2å€æ æ†ã€5%ä»“ä½è¯•æ¢ï¼Œæ­¢æŸ1.5å€ATRï¼Œåˆ†ä¸‰æ¡£æ­¢ç›ˆã€‚é¢„æœŸæŒä»“12-48å°æ—¶ï¼Œä¸æ‹æˆ˜ã€‚"
}
```

**Promptæ¨¡æ¿**:
```
## è§’è‰²è®¾å®š

ä½ æ˜¯ä¸€ä½æ‹¥æœ‰15å¹´äº¤æ˜“ç»éªŒçš„é¦–å¸­äº¤æ˜“å®˜ï¼Œä¸“æ³¨äºåŠ å¯†è´§å¸çš„ä¸­ä½é¢‘è¶‹åŠ¿äº¤æ˜“ã€‚

### âš ï¸ ç¬¬ä¸€æ¡é“å¾‹ï¼šé£æ§å®˜ä¸€ç¥¨å¦å†³æƒï¼ˆå¿…é¡»ä¸¥æ ¼éµå®ˆï¼‰

**è¿™æ˜¯System Promptçš„ç¬¬ä¸€æ¡æŒ‡ä»¤ï¼Œä¼˜å…ˆçº§æœ€é«˜ï¼Œä¸å¯è¿åï¼š**

å¦‚æœé£æ§å®˜æŠ¥å‘Šä¸­çš„ `position_allowed` ä¸º `false`ï¼Œä½ å¿…é¡»ï¼š
1. **æ— æ¡ä»¶è¾“å‡º `action: "no_action"`**
2. **ä¸å…è®¸ä»»ä½•ç†ç”±åé©³æˆ–è§£é‡Š**
3. **ä¸å…è®¸å°è¯•"å’Œç¨€æ³¥"æˆ–å¼ºè¡Œè§£é‡Šå¼€ä»“**
4. **ä¸å…è®¸å› ä¸ºæŠ€æœ¯åˆ†æçœ‹å¤šæˆ–æƒ…ç»ªåˆ†æçœ‹å¤šè€Œå¿½ç•¥é£æ§å®˜çš„å¦å†³**

**ç¤ºä¾‹åœºæ™¯**ï¼š
- æŠ€æœ¯åˆ†æï¼šå¼ºçƒˆçœ‹å¤šï¼ˆ+80åˆ†ï¼‰â†’ å»ºè®®åšå¤š
- æƒ…ç»ªåˆ†æï¼šæåº¦è´ªå©ªï¼ˆå»ºè®®åšç©ºï¼‰
- é£æ§ï¼š`position_allowed: false`ï¼ˆRisk Score > 0.7ï¼‰â†’ **ç¦æ­¢å¼€ä»“**

**æ­£ç¡®å†³ç­–**ï¼š`action: "no_action"`ï¼Œreasoningä¸­è¯´æ˜ï¼š"é£æ§å®˜å·²ç¦æ­¢å¼€ä»“ï¼Œé£é™©è¯„åˆ†è¿‡é«˜ï¼Œæ— æ¡ä»¶éµå®ˆé£æ§å†³å®šã€‚"

**é”™è¯¯å†³ç­–**ï¼šä»»ä½•è¯•å›¾è§£é‡Š"è™½ç„¶é£æ§ç¦æ­¢ï¼Œä½†æŠ€æœ¯é¢å¾ˆå¼ºï¼Œå¯ä»¥è½»ä»“è¯•æ¢"çš„è¡Œä¸ºéƒ½æ˜¯è¿åè§„åˆ™çš„ã€‚

**å†²çªè§£å†³ä¼˜å…ˆçº§**ï¼š
1. **é£æ§å®˜å¦å†³æƒ**ï¼ˆæœ€é«˜ä¼˜å…ˆçº§ï¼Œä¸€ç¥¨å¦å†³ï¼‰
2. æŠ€æœ¯åˆ†æä¸æƒ…ç»ªåˆ†æçš„å†²çªï¼šç»¼åˆåˆ¤æ–­ï¼Œä½†å¿…é¡»åœ¨é£æ§å…è®¸çš„å‰æä¸‹
3. å…¶ä»–å› ç´ ï¼šåœ¨é£æ§å’ŒæŠ€æœ¯/æƒ…ç»ªéƒ½å…è®¸çš„æƒ…å†µä¸‹è€ƒè™‘

### ä½ çš„äº¤æ˜“æ¡†æ¶
- **å‘¨æœŸé€‰æ‹©**: ä½ åšçš„æ˜¯15åˆ†é’Ÿ/4å°æ—¶/æ—¥çº¿çº§åˆ«çš„è¶‹åŠ¿äº¤æ˜“ï¼Œä¸åšè¶…çŸ­çº¿
- **æ ¸å¿ƒæ–¹æ³•**: æ—¥çº¿å®šæ–¹å‘ï¼Œ4å°æ—¶æ‰¾ç»“æ„ï¼Œ15åˆ†é’Ÿæ‰¾å…¥åœºç‚¹
- **æŒä»“æ—¶é—´**: é€šå¸¸12å°æ—¶åˆ°å‡ å¤©ï¼Œä¸åšæ—¥å†…è¶…çŸ­ï¼Œä¹Ÿä¸åšé•¿çº¿æŒä»“

### ä½ çš„äº¤æ˜“å±¥å†
- ç»å†è¿‡2017ç‰›å¸‚ã€2018ç†Šå¸‚ã€2020å¹´312ã€2021å¹´519ã€2022å¹´LUNA/FTX
- è¿™äº›ç»å†è®©ä½ æ·±åˆ»ç†è§£ï¼šé¡ºåŠ¿äº¤æ˜“+ä¸¥æ ¼é£æ§+åˆç†ä»“ä½=é•¿æœŸç”Ÿå­˜
- ä½ ä¸è¿½æ±‚æš´å¯Œï¼Œè¿½æ±‚çš„æ˜¯ç¨³å®šç›ˆåˆ©å’Œæ´»å¾—ä¹…

### ä½ çš„äº¤æ˜“å“²å­¦
- "æ—¥çº¿çœ‹æ–¹å‘ï¼Œ4å°æ—¶çœ‹ç»“æ„ï¼Œ15åˆ†é’Ÿçœ‹å…¥åœº"
- "ä¸å’Œè¶‹åŠ¿ä½œå¯¹ï¼Œä½†ä¹Ÿä¸åœ¨è¶‹åŠ¿æœ«æœŸè¿½é«˜"
- "ä»“ä½ç®¡ç†æ¯”æ–¹å‘åˆ¤æ–­æ›´é‡è¦"
- "æ¯ä¸€ç¬”äº¤æ˜“éƒ½è¦æƒ³å¥½é”™äº†æ€ä¹ˆåŠ"
- "æ²¡æœ‰100%ç¡®å®šçš„äº¤æ˜“ï¼Œåªæœ‰æ­£æœŸæœ›å€¼çš„ç³»ç»Ÿ"

### ä½ çš„å†³ç­–åŸåˆ™
- è‡³å°‘ä¸¤ä¸ªå‘¨æœŸå…±æŒ¯æ‰è€ƒè™‘å…¥åœºï¼ˆå¦‚4å°æ—¶+15åˆ†é’ŸåŒå‘ï¼‰
- æ—¥çº¿è¶‹åŠ¿æ˜¯å¤§æ–¹å‘ï¼Œä¸é€†ç€æ—¥çº¿åšå•
- 4å°æ—¶çº§åˆ«çš„MACDé‡‘å‰/æ­»å‰æ˜¯é‡è¦çš„ç»“æ„ä¿¡å·
- 15åˆ†é’Ÿç”¨æ¥ç²¾ç¡®å…¥åœºï¼Œæ‰¾åˆ°å¥½çš„é£é™©å›æŠ¥æ¯”
- é£é™©å›æŠ¥æ¯”è‡³å°‘2:1æ‰å€¼å¾—åš
- å•ç¬”é£é™©ä¸è¶…è¿‡2%

### ä½ çš„æ—¶é—´æ¡†æ¶æ€ç»´
- 15åˆ†é’Ÿä¿¡å·ï¼šæŒä»“é¢„æœŸ4-12å°æ—¶
- 4å°æ—¶ä¿¡å·ï¼šæŒä»“é¢„æœŸ12-48å°æ—¶
- æ—¥çº¿ä¿¡å·ï¼šæŒä»“é¢„æœŸ2-7å¤©
- ä½ ç›®å‰ä¸»è¦åš4å°æ—¶çº§åˆ«çš„äº¤æ˜“ï¼Œç”¨15åˆ†é’Ÿä¼˜åŒ–å…¥åœº

---

## å†³ç­–ä¼šè®®

{cto_input_data}

---

## ä½ çš„ä»»åŠ¡

ç”¨ç¬¬ä¸€äººç§°è§†è§’ï¼Œåƒè€äº¤æ˜“å‘˜è‡ªè¨€è‡ªè¯­ä¸€æ ·å®Œæˆåˆ†æå’Œå†³ç­–ï¼š

### 1. å¸‚åœºç»“æ„åˆ†æï¼ˆanalysis.market_structureï¼‰
- æ—¥çº¿åœ¨ä»€ä¹ˆè¶‹åŠ¿é‡Œï¼Ÿæ˜¯ä¸Šæ¶¨ã€ä¸‹è·Œè¿˜æ˜¯éœ‡è¡ï¼Ÿ
- 4å°æ—¶ç°åœ¨æ˜¯ä»€ä¹ˆç»“æ„ï¼Ÿé‡‘å‰è¿˜æ˜¯æ­»å‰ï¼Ÿå›è°ƒè¿˜æ˜¯çªç ´ï¼Ÿ
- 15åˆ†é’Ÿå‘ˆç°ä»€ä¹ˆå½¢æ€ï¼Ÿæ˜¯å¦é€‚åˆå…¥åœºï¼Ÿ
- ä¸‰ä¸ªå‘¨æœŸæ˜¯å¦å…±æŒ¯ï¼Ÿ

### 2. æƒ…ç»ªé¢åˆ¤æ–­ï¼ˆanalysis.sentiment_overviewï¼‰
- æè´ªæŒ‡æ•°è¯´æ˜ä»€ä¹ˆï¼Ÿæ˜¯å¦æç«¯ï¼Ÿ
- èµ„é‡‘è´¹ç‡é«˜ä¸é«˜ï¼Ÿå¤šå¤´æ‹¥æŒ¤å—ï¼Ÿ
- æœºæ„åœ¨ä¹°è¿˜æ˜¯åœ¨å–ï¼ˆETFèµ„é‡‘æµï¼‰ï¼Ÿ
- ç»¼åˆæƒ…ç»ªæ”¯æŒåšå¤šè¿˜æ˜¯åšç©ºï¼Ÿ

### 3. é£é™©è¯„ä¼°ï¼ˆanalysis.risk_assessmentï¼‰
- é£æ§å®˜çš„è¯„åˆ†å’Œå»ºè®®æ˜¯ä»€ä¹ˆï¼Ÿ
- ä½ è®¤å¯è¿™ä¸ªé£é™©è¯„ä¼°å—ï¼Ÿ
- ä»“ä½å’Œæ æ†æ‰“ç®—æ€ä¹ˆè®¾ç½®ï¼Ÿ

### 4. æ ¸å¿ƒé€»è¾‘ï¼ˆanalysis.core_logicï¼‰
- ç”¨ä¸€æ®µè¯æ€»ç»“ï¼šä¸ºä»€ä¹ˆè¦åšè¿™ç¬”äº¤æ˜“ï¼Ÿ

### 5. å†³ç­–ï¼ˆdecisionï¼‰
- action: open_long / open_short / no_action
- reasoning: ä¸ºä»€ä¹ˆè¿™ä¹ˆå†³å®šï¼Ÿ

### 6. æ‰§è¡Œè®¡åˆ’ï¼ˆexecutionï¼‰
- å…¥åœºä»·ä½å’Œæ–¹å¼
- æ æ†å’Œä»“ä½

### 7. æ­¢ç›ˆæ­¢æŸè®¡åˆ’ï¼ˆplans + plans_reasoningï¼‰
- è®¾ç½®åˆ†æ¡£æ­¢ç›ˆæ­¢æŸ
- amountç”¨**ç™¾åˆ†æ¯”**ï¼ˆå¦‚30è¡¨ç¤º30%ä»“ä½ï¼‰
- æ­¢ç›ˆç™¾åˆ†æ¯”ä¹‹å’Œåº”ä¸º100%ï¼ˆå…¨éƒ¨ä»“ä½åˆ†é…å®Œï¼‰
- æ­¢æŸç»Ÿä¸€è®¾100%ï¼ˆè§¦å‘åˆ™å…¨éƒ¨æ­¢æŸï¼‰
- è§£é‡Šä¸ºä»€ä¹ˆè¿™æ ·è®¾ç½®

### 8. æ—¶é—´æ¡†æ¶ï¼ˆtime_frameï¼‰
- è¿™ç¬”äº¤æ˜“é¢„æœŸæŒä»“å¤šä¹…ï¼Ÿ
- åŸºäºä»€ä¹ˆå‘¨æœŸçº§åˆ«çš„ä¿¡å·ï¼Ÿ
- æœ€é•¿æŒä»“æ—¶é—´ï¼Ÿ

### 9. å¤±æ•ˆæ¡ä»¶ï¼ˆinvalidationï¼‰
- ä»€ä¹ˆä»·ä½/æ¡ä»¶ä¸‹å¼€ä»“é€»è¾‘å¤±æ•ˆï¼Ÿ
- å¤±æ•ˆåæ€ä¹ˆå¤„ç†ï¼Ÿ

### 10. é£é™©æç¤ºï¼ˆwarningsï¼‰
- è¿™ç¬”äº¤æ˜“éœ€è¦è­¦æƒ•ä»€ä¹ˆï¼Ÿ
- ä»€ä¹ˆæƒ…å†µéœ€è¦æå‰è¡ŒåŠ¨ï¼Ÿ

### 11. æ€»ç»“ï¼ˆsummaryï¼‰
- ä¸€æ®µè¯æ¦‚æ‹¬è¿™ç¬”äº¤æ˜“

---

## è¾“å‡ºæ ¼å¼

```json
{
  "analyst": "cto",
  "timestamp": "ISOæ—¶é—´",
  "symbol": "äº¤æ˜“å¯¹",
  "current_price": å½“å‰ä»·,
  
  "analysis": {
    "market_structure": "å¤šå‘¨æœŸç»“æ„åˆ†æ...",
    "sentiment_overview": "æƒ…ç»ªé¢åˆ†æ...",
    "risk_assessment": "é£é™©è¯„ä¼°...",
    "core_logic": "æ ¸å¿ƒäº¤æ˜“é€»è¾‘..."
  },
  
  "decision": {
    "action": "open_long/open_short/no_action",
    "reasoning": "å†³ç­–ç†ç”±..."
  },
  
  "execution": {
    "entry": {"price": ä»·æ ¼, "type": "limit/market", "reason": "ç†ç”±"},
    "position": {"leverage": æ æ†, "size_percent": ä»“ä½ç™¾åˆ†æ¯”, "reason": "ç†ç”±"}
  },
  
  "plans": [
    {"take_profit": ä»·æ ¼, "amount": ç™¾åˆ†æ¯”, "reason": "ç†ç”±"},
    {"stop_loss": ä»·æ ¼, "amount": ç™¾åˆ†æ¯”, "reason": "ç†ç”±"}
  ],
  // æ³¨æ„ï¼šamountæ˜¯ç™¾åˆ†æ¯”ï¼ˆ30=30%ï¼‰ï¼Œæ­¢ç›ˆåˆ†æ¡£ä¹‹å’Œ=100%ï¼Œæ­¢æŸè®¾100%
  
  "plans_reasoning": "æ­¢ç›ˆæ­¢æŸè®¾ç½®çš„æ•´ä½“é€»è¾‘...",
  
  "time_frame": {
    "expected_duration": "é¢„æœŸæŒä»“æ—¶é—´",
    "logic": "æ—¶é—´æ¡†æ¶çš„é€»è¾‘",
    "max_holding": "æœ€é•¿æŒä»“æ—¶é—´"
  },
  
  "invalidation": {
    "price": å¤±æ•ˆä»·æ ¼,
    "condition": "å¤±æ•ˆæ¡ä»¶",
    "action": "å¤±æ•ˆåè¡ŒåŠ¨"
  },
  
  "warnings": ["è­¦å‘Š1", "è­¦å‘Š2"],
  
  "summary": "ä¸€æ®µè¯æ€»ç»“"
}
```

**æ ¸å¿ƒè¦æ±‚**ï¼š
1. ç”¨ä¸­æ–‡ï¼Œç¬¬ä¸€äººç§°ï¼Œåƒäº¤æ˜“å‘˜è‡ªè¨€è‡ªè¯­
2. å¤šå‘¨æœŸåˆ†æè¦ä½“ç°15m/4h/1dçš„å±‚æ¬¡
3. æ—¶é—´æ¡†æ¶è¦æ˜ç¡®ï¼ˆè¿™æ˜¯4å°æ—¶çº§åˆ«çš„äº¤æ˜“è¿˜æ˜¯æ—¥çº¿çº§åˆ«çš„ï¼Ÿï¼‰
4. æ­¢ç›ˆæ­¢æŸçš„amountç”¨ç™¾åˆ†æ¯”ï¼ˆ30/40/30è¿™æ ·ï¼‰
5. ç®€æ´æœ‰åŠ›ï¼Œä¸è¦åºŸè¯
```

---

### 2.4.1 CTOçš„å†³ç­–æƒé‡ä¸å†²çªè§£å†³

#### é—®é¢˜æè¿°

CTOæç¤ºè¯ä¸­æåˆ°"ç»¼åˆå„åˆ†æå¸ˆæ„è§"ï¼Œä½†åœ¨å®é™…å†³ç­–ä¸­å¯èƒ½å‡ºç°åˆ†æå¸ˆæ„è§å†²çªçš„æƒ…å†µï¼Œéœ€è¦æ˜ç¡®çš„å†²çªè§£å†³æœºåˆ¶ã€‚

#### å…¸å‹å†²çªåœºæ™¯

**åœºæ™¯1ï¼šæŠ€æœ¯é¢ä¸é£æ§å†²çª**
- æŠ€æœ¯åˆ†æï¼šå¼ºçƒˆçœ‹å¤šï¼ˆ+80åˆ†ï¼‰
- æƒ…ç»ªåˆ†æï¼šæåº¦è´ªå©ªï¼ˆå»ºè®®åšç©ºï¼‰
- é£æ§ï¼š`position_allowed: false`ï¼ˆRisk Score > 0.7ï¼‰

**åœºæ™¯2ï¼šæŠ€æœ¯é¢ä¸æƒ…ç»ªé¢å†²çª**
- æŠ€æœ¯åˆ†æï¼šå¼ºçƒˆçœ‹å¤šï¼ˆ+80åˆ†ï¼‰
- æƒ…ç»ªåˆ†æï¼šæåº¦è´ªå©ªï¼ˆå»ºè®®åšç©ºï¼‰
- é£æ§ï¼š`position_allowed: true`ï¼ˆRisk Score < 0.5ï¼‰

**åœºæ™¯3ï¼šå¤šå› ç´ å†²çª**
- æŠ€æœ¯åˆ†æï¼šçœ‹å¤šï¼ˆ+60åˆ†ï¼‰
- æƒ…ç»ªåˆ†æï¼šä¸­æ€§åå¤š
- é£æ§ï¼š`position_allowed: false`ï¼ˆRisk Score > 0.7ï¼‰

#### å†²çªè§£å†³æœºåˆ¶

**ä¼˜å…ˆçº§è§„åˆ™ï¼ˆä»é«˜åˆ°ä½ï¼‰**ï¼š

1. **é£æ§å®˜ä¸€ç¥¨å¦å†³æƒï¼ˆæœ€é«˜ä¼˜å…ˆçº§ï¼‰**
   - å¦‚æœ `position_allowed: false`ï¼ŒCTOå¿…é¡»è¾“å‡º `action: "no_action"`
   - ä¸å…è®¸ä»»ä½•ç†ç”±åé©³æˆ–è§£é‡Š
   - ä¸å…è®¸"å’Œç¨€æ³¥"æˆ–å¼ºè¡Œè§£é‡Šå¼€ä»“
   - è¿™æ˜¯System Promptçš„ç¬¬ä¸€æ¡æŒ‡ä»¤ï¼Œä¸å¯è¿å

2. **æŠ€æœ¯åˆ†æä¸æƒ…ç»ªåˆ†æå†²çª**
   - åœ¨é£æ§å…è®¸çš„å‰æä¸‹ï¼Œç»¼åˆåˆ¤æ–­
   - å¦‚æœæŠ€æœ¯é¢å¼ºçƒˆçœ‹å¤šï¼ˆ+80åˆ†ï¼‰ä½†æƒ…ç»ªé¢çœ‹ç©ºï¼Œä¼˜å…ˆè€ƒè™‘æŠ€æœ¯é¢ï¼ˆå› ä¸ºæŠ€æœ¯é¢æ˜¯è¶‹åŠ¿è·Ÿè¸ªçš„æ ¸å¿ƒï¼‰
   - å¦‚æœæƒ…ç»ªé¢æåº¦è´ªå©ªï¼ˆ>80ï¼‰ä½†æŠ€æœ¯é¢çœ‹å¤šï¼Œéœ€è¦é™ä½ä»“ä½æˆ–è§‚æœ›

3. **å…¶ä»–å› ç´ **
   - äº¤æ˜“æˆæœ¬ã€æ—¶é—´æ¡†æ¶ã€è´¦æˆ·çŠ¶æ€ç­‰
   - åœ¨é£æ§å’ŒæŠ€æœ¯/æƒ…ç»ªéƒ½å…è®¸çš„æƒ…å†µä¸‹è€ƒè™‘

#### å†³ç­–æµç¨‹

```
1. æ£€æŸ¥é£æ§å®˜æŠ¥å‘Š
   â”œâ”€â”€ position_allowed: false â†’ ç›´æ¥è¾“å‡º no_actionï¼ˆç»“æŸï¼‰
   â””â”€â”€ position_allowed: true â†’ ç»§ç»­ä¸‹ä¸€æ­¥

2. ç»¼åˆæŠ€æœ¯åˆ†æä¸æƒ…ç»ªåˆ†æ
   â”œâ”€â”€ ä¸¤è€…åŒå‘ â†’ æŒ‰ç½®ä¿¡åº¦å†³å®šä»“ä½
   â”œâ”€â”€ æŠ€æœ¯é¢å¼ºä½†æƒ…ç»ªé¢å¼± â†’ é™ä½ä»“ä½ï¼Œè°¨æ…å¼€ä»“
   â””â”€â”€ æŠ€æœ¯é¢å¼±ä½†æƒ…ç»ªé¢å¼º â†’ è§‚æœ›æˆ–è½»ä»“è¯•æ¢

3. è€ƒè™‘å…¶ä»–å› ç´ 
   â”œâ”€â”€ äº¤æ˜“æˆæœ¬ï¼ˆèµ„é‡‘è´¹ç‡ã€æ‰‹ç»­è´¹ï¼‰
   â”œâ”€â”€ æ—¶é—´æ¡†æ¶åŒ¹é…åº¦
   â””â”€â”€ è´¦æˆ·çŠ¶æ€ï¼ˆä½™é¢ã€å·²æœ‰æŒä»“ï¼‰
```

#### å®æ–½å»ºè®®

1. **åœ¨Promptä¸­æ˜ç¡®å†™å…¥**ï¼šé£æ§å®˜ä¸€ç¥¨å¦å†³æƒä½œä¸ºSystem Promptçš„ç¬¬ä¸€æ¡æŒ‡ä»¤
2. **ä»£ç å±‚é¢æ ¡éªŒ**ï¼šåœ¨æ‰§è¡ŒCTOå†³ç­–å‰ï¼Œæ£€æŸ¥é£æ§å®˜çš„`position_allowed`å­—æ®µ
3. **æ—¥å¿—è®°å½•**ï¼šè®°å½•æ‰€æœ‰å†²çªåœºæ™¯å’ŒCTOçš„å†³ç­–è¿‡ç¨‹ï¼Œä¾¿äºåç»­ä¼˜åŒ–

#### ä»£ç å®ç°ç¤ºä¾‹

```python
def validate_cto_decision(cto_decision: dict, risk_report: dict) -> tuple[bool, str]:
    """
    æ ¡éªŒCTOå†³ç­–æ˜¯å¦ç¬¦åˆé£æ§è¦æ±‚
    è¿”å›: (æ˜¯å¦é€šè¿‡, æ‹’ç»åŸå› )
    """
    # é£æ§å®˜ä¸€ç¥¨å¦å†³æƒæ£€æŸ¥
    if not risk_report.get("assessment", {}).get("position_allowed", True):
        if cto_decision.get("decision", {}).get("action") != "no_action":
            return False, "é£æ§å®˜å·²ç¦æ­¢å¼€ä»“ï¼Œä½†CTOä»å»ºè®®å¼€ä»“ï¼Œè¿åä¸€ç¥¨å¦å†³æƒè§„åˆ™"
    
    return True, ""
```

---

### 2.5 æŒä»“ç®¡ç†AI (Position Manager)

**æ¨¡å‹**: Claude-Sonnet-4.5

**èŒè´£**: ä»¥ç¬¬ä¸€äººç§°è§†è§’ç›‘æ§ç°æœ‰æŒä»“ï¼ŒåŠ¨æ€è°ƒæ•´ç­–ç•¥

**é¢„å¤„ç†åçš„è¾“å…¥æ ¼å¼**:

```
## æŒä»“ç®¡ç†æ•°æ®æ‘˜è¦
ç”Ÿæˆæ—¶é—´: 2024-01-15 12:45:00 UTC
äº¤æ˜“å¯¹: BTCUSDT

---

### ä¸€ã€å½“å‰æŒä»“çŠ¶æ€

#### åŸºæœ¬ä¿¡æ¯
- æŒä»“ID: pos_123456
- æ–¹å‘: å¤šå¤´ (Long)
- å…¥åœºä»·: 42,800 USDT
- å½“å‰ä»·: 43,500 USDT
- æ æ†: 2x

#### ç›ˆäºçŠ¶æ€
- æµ®åŠ¨ç›ˆäº: +350 USDT
- ç›ˆäºæ¯”ä¾‹: +1.63%
- æŒä»“æ—¶é—´: 2å°æ—¶15åˆ†é’Ÿ

#### æ­¢æŸæ­¢ç›ˆè®¾ç½®
- å½“å‰æ­¢æŸ: 42,271 (-1.35%)
- å½“å‰æ­¢ç›ˆ: 45,000 (+5.14%)
- å¼ºå¹³ä»·æ ¼: 38,500

#### çŠ¶æ€è¯„ä¼°
| æŒ‡æ ‡ | å€¼ | çŠ¶æ€ |
|------|-----|------|
| ç›ˆäº | +1.63% | âœ… ç›ˆåˆ©ä¸­ |
---

### äºŒã€åŸå§‹å¼€ä»“å†³ç­–ï¼ˆCTOå®Œæ•´æ€ç»´é“¾ï¼‰

```
å†³ç­–æ—¶é—´: 2024-01-15 10:30:00
æ–¹å‘: åšå¤š
ç½®ä¿¡åº¦: 0.75

CTOåˆ†ææ€è·¯:
"æ—¥çº¿å¤šå¤´è¶‹åŠ¿æ˜ç¡®ï¼Œ4å°æ—¶åˆšå‡ºç°MACDé‡‘å‰ï¼Œ15åˆ†é’Ÿå›è°ƒåˆ°EMA21è·å¾—æ”¯æ’‘ï¼Œä¸‰å‘¨æœŸå…±æŒ¯å‘ä¸Šã€‚
è¿™æ˜¯ä¸€ç¬”4å°æ—¶çº§åˆ«çš„é¡ºåŠ¿äº¤æ˜“ã€‚ETFè¿ç»­5æ—¥æµå…¥è¯´æ˜æœºæ„åœ¨ä¹°ï¼Œè™½ç„¶æè´ªæŒ‡æ•°72åé«˜ä½†è¿˜æ²¡åˆ°
æç«¯åŒºã€‚é£æ§ç»™çš„0.35è¯„åˆ†å¯æ¥å—ã€‚æˆ‘ç”¨2å€æ æ†ã€5%ä»“ä½è¿›åœºï¼Œé£é™©å›æŠ¥æ¯”2.4:1ã€‚"

å¼€ä»“ä¾æ®:
1. æ—¥çº¿å¤šå¤´è¶‹åŠ¿ + 4å°æ—¶MACDé‡‘å‰ + 15åˆ†é’ŸEMAæ”¯æ’‘
2. ETFè¿ç»­5æ—¥å‡€æµå…¥ï¼Œæœºæ„çœ‹å¥½
3. é£æ§è¯„åˆ†0.35å¯æ¥å—

å¤±æ•ˆæ¡ä»¶: è·Œç ´42,150 (4h EMA21) â€”â€” è·Œç ´è¯´æ˜4å°æ—¶ç»“æ„è¢«ç ´å

é¢„æœŸæŒä»“æ—¶é—´: 12-48å°æ—¶ï¼ˆ4å°æ—¶çº§åˆ«äº¤æ˜“ï¼‰

åŸå®šæ­¢ç›ˆæ­¢æŸ:
- æ­¢æŸ: 42,271 (1.5å€ATR)
- æ­¢ç›ˆ1: 43,450 (30%) - 15m BBä¸Šè½¨
- æ­¢ç›ˆ2: 44,200 (40%) - 4h BBä¸Šè½¨  
- æ­¢ç›ˆ3: 45,000 (30%) - å‰é«˜
```

---

### ä¸‰ã€ç´¯è®¡äº¤æ˜“æˆæœ¬

| æˆæœ¬é¡¹ | é‡‘é¢ | è¯´æ˜ |
|--------|------|------|
| å¼€ä»“æ‰‹ç»­è´¹ | -2.57 USDT | 0.06% Ã— 4,280 |
| å·²æ‰£èµ„é‡‘è´¹ç‡ | -5.35 USDT | 0.0125% Ã— 2æ¬¡ |
| **ç´¯è®¡æˆæœ¬** | **-7.92 USDT** | |

å½“å‰èµ„é‡‘è´¹ç‡: 0.0130%ï¼ˆæ¯8å°æ—¶ï¼‰
ä¸‹æ¬¡æ‰£è´¹æ—¶é—´: 2024-01-15 16:00:00 UTC
é¢„è®¡ä¸‹æ¬¡æ‰£è´¹: -2.78 USDT

**æˆæœ¬æé†’**: æ¯æ¬¡æ“ä½œï¼ˆåŠ ä»“/å‡ä»“/å¹³ä»“ï¼‰éƒ½ä¼šäº§ç”Ÿæ‰‹ç»­è´¹

---

### å››ã€æœ€æ–°æŠ€æœ¯çŠ¶æ€

| å‘¨æœŸ | EMAæ’åˆ— | RSI | MACD | å˜åŒ– |
|------|---------|-----|------|------|
| 15åˆ†é’Ÿ | å¤šå¤´ âœ… | 68.2 âš ï¸ | æ‰©å¼  âœ… | RSIæ¥è¿‘è¶…ä¹° |
| 4å°æ—¶ | å¤šå¤´ âœ… | 61.2 | æ‰©å¼  âœ… | è¶‹åŠ¿å®Œå¥½ |

---

### äº”ã€æœ€æ–°æƒ…ç»ªçŠ¶æ€

| æŒ‡æ ‡ | å½“å‰ | å˜åŒ– |
|------|------|------|
| æè´ªæŒ‡æ•° | 73 | +1 |
| èµ„é‡‘è´¹ç‡ | 0.0130% | âš ï¸ ç»§ç»­ä¸Šå‡ |

---

### å…­ã€å…³é”®ä»·ä½

- æ”¯æ’‘: 43,200 / 42,850 / 42,271(æ­¢æŸ)
- é˜»åŠ›: 43,800 / 44,200 / 45,000(æ­¢ç›ˆ)

---

è¯·å¯¹è¿™ä¸ªæŒä»“è¿›è¡Œç®¡ç†å†³ç­–ã€‚
```

**è¾“å‡ºç»“æ„**:

```json
{
  "analyst": "position_manager",
  "timestamp": "2024-01-15T12:45:00Z",
  "position_id": "pos_123456",
  "symbol": "ETHUSDT",
  
  "analysis": {
    "market": "BTCåœ¨å…³é”®é˜»åŠ›ä½éœ‡è¡ï¼Œå¤§ç›˜æƒ…ç»ªåè°¨æ…ï¼ŒETHè·Ÿéšä½†ç›¸å¯¹å¼ºåŠ¿ã€‚4å°æ—¶çº§åˆ«å¤šå¤´è¶‹åŠ¿å®Œå¥½ï¼Œ15åˆ†é’Ÿå‡ºç°è¶…ä¹°è¿¹è±¡ã€‚",
    "sentiment": "æè´ªæŒ‡æ•°72åè´ªå©ªä½†æœªæç«¯ï¼Œèµ„é‡‘è´¹ç‡0.013%å¤šå¤´ç•¥æ‹¥æŒ¤ï¼ŒETFè¿ç»­5æ—¥å‡€æµå…¥æ˜¾ç¤ºæœºæ„ä»åœ¨ä¹°å…¥ã€‚æ•´ä½“æƒ…ç»ªåå¤šä½†éœ€è­¦æƒ•è¿‡çƒ­ã€‚",
    "position": "æŒä»“6ä¸ªETHï¼Œå…¥åœºä»·3280ï¼Œå½“å‰3350ï¼Œç›ˆåˆ©2.13%ã€‚ç´¯è®¡æˆæœ¬7.92 USDTï¼ˆæ‰‹ç»­è´¹+èµ„é‡‘è´¹ç‡ï¼‰ã€‚å¼€ä»“é€»è¾‘(ä¸‰å‘¨æœŸEMAå…±æŒ¯+MACDé‡‘å‰)ä¾ç„¶æœ‰æ•ˆã€‚"
  },
  
  "decision": {
    "action": "adjust_sl_tp",
    "reasoning": "å·²ç»ç›ˆåˆ©2%+äº†ï¼ŒæŒ‰æˆ‘çš„åŸåˆ™å¿…é¡»ä¿æŠ¤åˆ©æ¶¦ã€‚è¶‹åŠ¿è¿˜åœ¨ï¼Œæ²¡ç†ç”±ç°åœ¨è·‘ï¼Œä½†ä¹Ÿä¸èƒ½è®©ç›ˆåˆ©å˜äºæŸã€‚æ‰€ä»¥ä¸Šç§»æ­¢æŸåˆ°3300ï¼Œå³ä½¿å›è°ƒä¹Ÿèƒ½ä¿ä½0.6%çš„åˆ©æ¶¦ã€‚"
  },
  
  "plans": [
    {"take_profit": 3400, "amount": 1},
    {"take_profit": 3480, "amount": 2},
    {"take_profit": 3550, "amount": 1},
    {"stop_loss": 3300, "amount": 1},
    {"stop_loss": 3250, "amount": 1}
  ],
  
  "plans_reasoning": "6ä¸ªETHåˆ†é…ï¼šæ­¢ç›ˆ4ä¸ª(3400/3480/3550)ï¼Œæ­¢æŸ2ä¸ª(3300/3250)ã€‚",
  
  "next_steps": "ç›¯ç€RSIï¼Œè¿‡75å°±è€ƒè™‘æå‰å‡ä»“ã€‚MACDæ­»å‰å°±å…¨å¹³ã€‚",
  
  "wake_up": {
    "price_above": 3400,
    "price_below": 3280,
    "reason": "ä¸Šç ´3400è§¦å‘ç¬¬ä¸€æ¡£æ­¢ç›ˆï¼Œä¸‹ç ´3280å›åˆ°å…¥åœºä»·éœ€é‡æ–°è¯„ä¼°"
  }
}
}
```

---

**ä¸åŒæ“ä½œçš„è¾“å‡ºç¤ºä¾‹**ï¼š

### åŠ ä»“ (add)
```json
{
  "analysis": {
    "market": "BTCçªç ´å…³é”®é˜»åŠ›68000ï¼Œå¸¦åŠ¨å¤§ç›˜æƒ…ç»ªå›æš–ï¼Œå±±å¯¨å¼€å§‹è¡¥æ¶¨ã€‚",
    "sentiment": "æè´ªæŒ‡æ•°ä»65å‡åˆ°70ï¼Œèµ„é‡‘è´¹ç‡æ¸©å’Œï¼ŒETFå¤§é¢æµå…¥ï¼Œå¸‚åœºåšå¤šæ„æ„¿å¼ºçƒˆã€‚",
    "position": "æŒä»“6ä¸ªETHç›ˆåˆ©3.5%ï¼Œä»·æ ¼çªç ´3400ç¡®è®¤ï¼Œè¶‹åŠ¿åŠ é€Ÿè¿¹è±¡æ˜æ˜¾ã€‚"
  },
  
  "decision": {
    "action": "add",
    "reasoning": "çªç ´ç¡®è®¤äº†ï¼Œè¿™æ˜¯åŠ ä»“ä¿¡å·ã€‚åŸæ¥çš„ä»“ä½å·²ç»æœ‰åˆ©æ¶¦ä¿æŠ¤ï¼Œç°åœ¨åŠ 2ä¸ªETHæ”¾å¤§æ”¶ç›Šã€‚æ–°ä»“ä½æ­¢æŸè®¾åœ¨çªç ´ä½ä¸‹æ–¹ï¼Œå³ä½¿æ‰“æ­¢æŸä¹Ÿå°±äºæ–°åŠ çš„éƒ¨åˆ†ï¼ŒåŸä»“ä½åˆ©æ¶¦è¿˜åœ¨ã€‚"
  },
  
  "add_detail": {
    "amount": 2,
    "price": 3420,
    "position_after": 8
  },
  
  "plans": [
    {"take_profit": 3500, "amount": 2},
    {"take_profit": 3580, "amount": 3},
    {"take_profit": 3650, "amount": 1},
    {"stop_loss": 3380, "amount": 1},
    {"stop_loss": 3350, "amount": 1}
  ],
  
  "plans_reasoning": "åŠ ä»“å8ä¸ªETHï¼šæ­¢ç›ˆ6ä¸ªåˆ†ä¸‰æ¡£å‡º(3500/3580/3650)ï¼Œæ­¢æŸä¿æŠ¤2ä¸ª(3380/3350)ã€‚åŠ ä»“çš„2ä¸ªå¦‚æœé”™äº†ï¼Œ3380å°±å…ˆç 1ä¸ªè®¤é”™ã€‚",
  
  "next_steps": "åŠ ä»“åæ›´è¦ç›¯ç´§ï¼Œä»·æ ¼å¦‚æœå›è½åˆ°3400ä¸‹æ–¹å°±è¦è­¦æƒ•å‡çªç ´ã€‚ç«™ç¨³3450å†è€ƒè™‘ç»§ç»­åŠ ã€‚"
}
```

### å‡ä»“ (reduce)
```json
{
  "analysis": {
    "market": "BTCåœ¨69000é‡é˜»å›è½ï¼Œå¤§ç›˜å‡ºç°è·åˆ©å›åè¿¹è±¡ã€‚",
    "sentiment": "æè´ªæŒ‡æ•°78æ¥è¿‘æç«¯è´ªå©ªï¼Œèµ„é‡‘è´¹ç‡0.025%è¿‡é«˜ï¼Œå¤šå¤´è¿‡äºæ‹¥æŒ¤ã€‚",
    "position": "æŒä»“6ä¸ªETHç›ˆåˆ©5.2%ï¼ŒRSIå·²ç»78è¶…ä¹°ï¼ŒMACDæŸ±çŠ¶å›¾å¼€å§‹æ”¶ç¼©ã€‚"
  },
  
  "decision": {
    "action": "reduce",
    "reasoning": "æƒ…ç»ªè¿‡çƒ­+æŠ€æœ¯è¶…ä¹°ï¼Œè¿™ç§æ—¶å€™ä¸èƒ½è´ªã€‚è™½ç„¶è¶‹åŠ¿è¿˜æ²¡åï¼Œä½†ä¿¡å·åœ¨æ¶åŒ–ã€‚å…ˆå‡3ä¸ªé”å®šä¸€åŠåˆ©æ¶¦ï¼Œå‰©3ä¸ªç»§ç»­æ‹¿ã€‚å¯¹äº†å°‘èµšç‚¹ï¼Œé”™äº†ä¸ä¼šæŠŠåˆ©æ¶¦å…¨åå›å»ã€‚"
  },
  
  "reduce_detail": {
    "amount": 3,
    "price": 3450,
    "position_after": 3,
    "realized_pnl": 510
  },
  
  "plans": [
    {"take_profit": 3550, "amount": 1},
    {"stop_loss": 3380, "amount": 1},
    {"stop_loss": 3350, "amount": 1}
  ],
  
  "plans_reasoning": "å‰©3ä¸ªETHï¼š1ä¸ªç»§ç»­åš3550ç›®æ ‡ï¼Œ2ä¸ªç”¨æ­¢æŸä¿æŠ¤ã€‚å·²ç»è½è¢‹510Uäº†ï¼Œå‰©ä¸‹çš„ä»“ä½è½»æ¾æ‹¿ã€‚",
  
  "next_steps": "å‡ä»“åè§‚å¯Ÿï¼Œå¦‚æœRSIå›è½åˆ°60ä»¥ä¸‹ã€æƒ…ç»ªé™æ¸©ï¼Œå¯ä»¥è€ƒè™‘æ¥å›æ¥ã€‚å¦‚æœç»§ç»­æ¶åŒ–å°±æŠŠå‰©ä½™çš„ä¹Ÿå‡ºæ‰ã€‚"
}
```

### å¹³ä»“ (close)
```json
{
  "analysis": {
    "market": "BTCè·Œç ´66000å…³é”®æ”¯æ’‘ï¼Œå¤§ç›˜ææ…Œæ€§æŠ›å”®ï¼Œå±±å¯¨è·Œå¹…æ›´å¤§ã€‚",
    "sentiment": "æè´ªæŒ‡æ•°ä»72æš´è·Œåˆ°45ï¼Œèµ„é‡‘è´¹ç‡è½¬è´Ÿï¼ŒETFå‡ºç°å‡€æµå‡ºã€‚æƒ…ç»ªæ€¥å‰§æ¶åŒ–ã€‚",
    "position": "æŒä»“6ä¸ªETHï¼Œä»ç›ˆåˆ©2%å˜æˆäºæŸ0.5%ã€‚4å°æ—¶MACDæ­»å‰ç¡®è®¤ï¼Œè¶‹åŠ¿åè½¬ã€‚"
  },
  
  "decision": {
    "action": "close",
    "reasoning": "MACDæ­»å‰+è·Œç ´æ”¯æ’‘+æƒ…ç»ªå´©å¡Œï¼Œä¸‰é‡ç¡®è®¤è¶‹åŠ¿åè½¬ã€‚å¼€ä»“é€»è¾‘å·²ç»å¤±æ•ˆäº†ï¼Œæ²¡æœ‰ç»§ç»­æ‹¿çš„ç†ç”±ã€‚ç°åœ¨è·‘è¿˜æ˜¯å°äºï¼Œæ‹–ä¸‹å»å¯èƒ½å¤§äºã€‚è®¤é”™ç¦»åœºï¼Œä¿å­˜å®åŠ›ã€‚"
  },
  
  "close_detail": {
    "amount": 6,
    "price": 3260,
    "realized_pnl": -120
  },
  
  "plans": [],
  
  "plans_reasoning": "å…¨éƒ¨å¹³ä»“ï¼Œæ²¡æœ‰plansã€‚äºäº†120Uï¼Œä½†æ¯”ç»§ç»­æ‹¿ç€äºæ›´å¤šå¼ºã€‚",
  
  "next_steps": "ç¦»åœºè§‚æœ›ï¼Œç­‰å¸‚åœºä¼ç¨³å†è¯´ã€‚å…³æ³¨3200èƒ½ä¸èƒ½å®ˆä½ï¼Œå®ˆä½äº†å†æ‰¾æœºä¼šè¿›ã€‚è¿™æ³¢è®¤æ ½ï¼Œä¸‹æ¬¡æ³¨æ„è¶‹åŠ¿åè½¬ä¿¡å·ã€‚"
}
```

### ç»§ç»­æŒæœ‰ (hold)
```json
{
  "analysis": {
    "market": "BTCåœ¨67000-68000åŒºé—´éœ‡è¡æ•´ç†ï¼Œæ–¹å‘ä¸æ˜ã€‚",
    "sentiment": "æè´ªæŒ‡æ•°65ä¸­æ€§åå¤šï¼Œèµ„é‡‘è´¹ç‡æ­£å¸¸ï¼Œæ²¡æœ‰æç«¯ä¿¡å·ã€‚",
    "position": "æŒä»“6ä¸ªETHç›ˆåˆ©1.2%ï¼Œè¶‹åŠ¿å®Œå¥½ä½†åŠ¨èƒ½ä¸€èˆ¬ï¼Œæ²¡æœ‰æ–°çš„åˆ©å¥½æˆ–åˆ©ç©ºã€‚"
  },
  
  "decision": {
    "action": "hold",
    "reasoning": "æ²¡ä»€ä¹ˆå˜åŒ–ï¼Œå¼€ä»“é€»è¾‘è¿˜åœ¨ï¼Œè¶‹åŠ¿æ²¡åã€‚ç›ˆåˆ©1.2%ä¸å¤šä¸å°‘ï¼Œè¿˜æ²¡åˆ°å¿…é¡»ä¿æŠ¤çš„ç¨‹åº¦ã€‚ç»§ç»­æ‹¿ç€ï¼Œç­‰æ–¹å‘å‡ºæ¥å†è¯´ã€‚ç°æœ‰çš„æ­¢ç›ˆæ­¢æŸè®¡åˆ’ä¸å˜ã€‚"
  },
  
  "plans": [
    {"take_profit": 3400, "amount": 2},
    {"take_profit": 3480, "amount": 2},
    {"stop_loss": 3250, "amount": 1},
    {"stop_loss": 3200, "amount": 1}
  ],
  
  "plans_reasoning": "ç»´æŒåŸè®¡åˆ’ï¼Œæ­¢ç›ˆ4ä¸ª+æ­¢æŸ2ä¸ª=6ä¸ªã€‚æ²¡æœ‰è°ƒæ•´çš„å¿…è¦ã€‚",
  
  "next_steps": "ç»§ç»­è§‚å¯Ÿï¼Œå¦‚æœç›ˆåˆ©è¶…è¿‡2%å°±ä¸Šç§»æ­¢æŸä¿æŠ¤ã€‚å¦‚æœè·Œç ´3280å…¥åœºä»·å°±é‡æ–°è¯„ä¼°ã€‚"
}
```

**Promptæ¨¡æ¿**:
```
## è§’è‰²è®¾å®š

ä½ æ˜¯ä¸€ä½é¡¶å°–çš„åŠ å¯†è´§å¸æŒä»“ç®¡ç†ä¸“å®¶ï¼Œæ‹¥æœ‰15å¹´å®æˆ˜ç»éªŒã€‚ç”¨ç¬¬ä¸€äººç§°è§†è§’æ€è€ƒå’Œè¡¨è¾¾ï¼Œåƒä¸€ä¸ªè€ç»ƒçš„äº¤æ˜“å‘˜åœ¨è‡ªè¨€è‡ªè¯­ã€‚

### æ ¸å¿ƒåŸåˆ™
- ç›ˆåˆ©>2%å¿…é¡»ä¿æŠ¤åˆ©æ¶¦ï¼Œæ°¸è¿œä¸è®©2%+ç›ˆåˆ©å˜äºæŸ
- RSI>75è€ƒè™‘å‡ä»“ï¼ŒMACDæ­»å‰æ˜¯ç¦»åœºä¿¡å·
- å¼€ä»“é€»è¾‘å¤±æ•ˆå°±æœæ–­èµ°äºº

---

## æŒä»“æ•°æ®

{position_management_summary}

---

## ä½ çš„ä»»åŠ¡

ç”¨ç¬¬ä¸€äººç§°ï¼Œåƒè€äº¤æ˜“å‘˜è‡ªè¨€è‡ªè¯­ä¸€æ ·åˆ†æå’Œå†³ç­–ï¼š

### 1. åˆ†æï¼ˆanalysisï¼‰
- **market**: å¤§ç›˜æ€ä¹ˆæ ·ï¼ŸBTCåœ¨ä»€ä¹ˆä½ç½®ï¼Ÿæ•´ä½“è¶‹åŠ¿å¦‚ä½•ï¼Ÿ
- **sentiment**: æƒ…ç»ªé¢æ€ä¹ˆæ ·ï¼Ÿæè´ªæŒ‡æ•°ã€èµ„é‡‘è´¹ç‡è¯´æ˜ä»€ä¹ˆï¼Ÿ
- **position**: æˆ‘çš„ä»“ä½ç°åœ¨ä»€ä¹ˆæƒ…å†µï¼Ÿç´¯è®¡æˆæœ¬å¤šå°‘ï¼Ÿå¼€ä»“é€»è¾‘è¿˜æœ‰æ•ˆå—ï¼Ÿ

### 2. å†³ç­–ï¼ˆdecisionï¼‰
- **action**: hold / adjust_sl_tp / add / reduce / close
- **reasoning**: ä¸ºä»€ä¹ˆè¿™ä¹ˆåšï¼Ÿæ³¨æ„æ¯æ¬¡æ“ä½œéƒ½æœ‰æ‰‹ç»­è´¹æˆæœ¬

### 3. æ‰§è¡Œè®¡åˆ’ï¼ˆplansï¼‰
å¦‚æœæœ‰ä»“ä½å˜åŠ¨ï¼ˆadd/reduceï¼‰ï¼Œè¦ç»™å‡ºdetail
å¿…é¡»ç»™å‡ºplansæ•°ç»„ï¼š
- amountæ˜¯**å¸çš„æ•°é‡**ï¼ˆå¦‚2ä¸ªETHï¼‰ï¼Œä¸æ˜¯ç™¾åˆ†æ¯”
- æ­¢ç›ˆamountä¹‹å’Œ + æ­¢æŸamountä¹‹å’Œ = æ“ä½œåæ€»ä»“ä½

### 4. Plansç†ç”±ï¼ˆplans_reasoningï¼‰
ä¸ºä»€ä¹ˆè¿™æ ·è®¾ç½®æ­¢ç›ˆæ­¢æŸï¼Ÿ

### 5. ä¸‹ä¸€æ­¥ï¼ˆnext_stepsï¼‰
æ¥ä¸‹æ¥ç›¯ä»€ä¹ˆï¼Ÿ

### 6. å”¤é†’ä»·æ ¼ï¼ˆwake_upï¼‰
è®¾ç½®ä¸‹æ¬¡æå‰å”¤é†’çš„ä»·æ ¼æ¡ä»¶ï¼ˆé»˜è®¤æ¯5åˆ†é’Ÿå”¤é†’ä¸€æ¬¡ï¼Œä½†å¯ä»¥è®¾ç½®ä»·æ ¼è§¦å‘æå‰å”¤é†’ï¼‰

---

## è¾“å‡ºæ ¼å¼

```json
{
  "analyst": "position_manager",
  "timestamp": "ISOæ—¶é—´",
  "position_id": "æŒä»“ID",
  "symbol": "äº¤æ˜“å¯¹",
  
  "analysis": {
    "market": "å¤§ç›˜åˆ†æ...",
    "sentiment": "æƒ…ç»ªé¢åˆ†æ...",
    "position": "æŒä»“çŠ¶æ€åˆ†æï¼ˆåŒ…å«ç´¯è®¡æˆæœ¬ï¼‰..."
  },
  
  "decision": {
    "action": "hold/adjust_sl_tp/add/reduce/close",
    "reasoning": "ç¬¬ä¸€äººç§°è§£é‡Šä¸ºä»€ä¹ˆè¿™ä¹ˆå†³ç­–..."
  },
  
  // å¦‚æœæ˜¯add
  "add_detail": {"amount": åŠ ä»“æ•°é‡, "price": ä»·æ ¼, "position_after": æ“ä½œåæ€»æ•°é‡},
  
  // å¦‚æœæ˜¯reduce  
  "reduce_detail": {"amount": å‡ä»“æ•°é‡, "price": ä»·æ ¼, "position_after": æ“ä½œåæ€»æ•°é‡, "realized_pnl": å·²å®ç°ç›ˆäº},
  
  // å¦‚æœæ˜¯close
  "close_detail": {"amount": å¹³ä»“æ•°é‡, "price": ä»·æ ¼, "realized_pnl": å·²å®ç°ç›ˆäº},
  
  "plans": [
    {"take_profit": ä»·æ ¼, "amount": æ•°é‡},
    {"stop_loss": ä»·æ ¼, "amount": æ•°é‡}
  ],
  
  "plans_reasoning": "ä¸ºä»€ä¹ˆè¿™æ ·è®¾ç½®æ­¢ç›ˆæ­¢æŸ...",
  
  "next_steps": "æ¥ä¸‹æ¥çš„è®¡åˆ’å’Œå…³æ³¨ç‚¹...",
  
  "wake_up": {
    "price_above": ä¸Šç ´æ­¤ä»·æ ¼æå‰å”¤é†’,
    "price_below": ä¸‹ç ´æ­¤ä»·æ ¼æå‰å”¤é†’,
    "reason": "ä¸ºä»€ä¹ˆè®¾ç½®è¿™ä¸ªå”¤é†’ä»·æ ¼"
  }
}
```

**å­—æ®µè¯´æ˜**ï¼š
- plans.amount: **å¸çš„æ•°é‡**ï¼ˆå¦‚ETHä¸ªæ•°ï¼‰ï¼Œä¸æ˜¯ç™¾åˆ†æ¯”
- æ ¡éªŒè§„åˆ™: æ‰€æœ‰plansçš„amountä¹‹å’Œ = æ“ä½œåæ€»ä»“ä½ï¼ˆposition_after æˆ–å½“å‰æŒä»“ï¼‰
- ç¤ºä¾‹: æŒä»“6ä¸ªETHï¼Œplansåº”è¯¥æ˜¯ æ­¢ç›ˆ4ä¸ª + æ­¢æŸ2ä¸ª = 6ä¸ª

**è¦æ±‚**ï¼š
1. ç”¨ä¸­æ–‡ï¼Œç¬¬ä¸€äººç§°ï¼Œåƒäº¤æ˜“å‘˜è‡ªè¨€è‡ªè¯­
2. plansæ­¢ç›ˆ+æ­¢æŸ=æ“ä½œåæ€»ä»“ä½ï¼ˆæ•°é‡ä¹‹å’Œï¼‰
3. ç®€æ´æœ‰åŠ›ï¼Œä¸è¦åºŸè¯
```

---

## ä¸‰ã€ç³»ç»Ÿå·¥ä½œæµç¨‹

### 3.1 å¼€ä»“æµç¨‹

```
1. å¸‚åœºä¿¡å·æ£€æµ‹å™¨è§¦å‘
         â†“
2. æ•°æ®é¢„å¤„ç†å±‚
   â”œâ”€â”€ prepare_technical_summary()
   â”œâ”€â”€ prepare_sentiment_summary()
   â””â”€â”€ prepare_risk_summary()
         â†“
3. å¹¶è¡Œè°ƒç”¨ä¸‰ä¸ªåˆ†æAI (è¶…æ—¶30ç§’)
   â”œâ”€â”€ æŠ€æœ¯åˆ†æå¸ˆ â†’ JSONæŠ¥å‘Š
   â”œâ”€â”€ æƒ…ç»ªåˆ†æå¸ˆ â†’ JSONæŠ¥å‘Š
   â””â”€â”€ é£æ§å®˜ â†’ JSONæŠ¥å‘Š
         â†“
4. ç»„è£…CTOè¾“å…¥ï¼Œè°ƒç”¨é¦–å¸­äº¤æ˜“å®˜
         â†“
5. è§£æCTOå†³ç­–JSON
         â†“
6. å†³ç­–æ‰§è¡Œ
   â”œâ”€â”€ no_action â†’ è®°å½•æ—¥å¿—
   â””â”€â”€ open_long/short â†’ è®¡ç®—å¼€ä»“æ•°é‡ â†’ è°ƒç”¨äº¤æ˜“æ‰€API
         â†“
7. åˆ›å»ºæŒä»“è®°å½•ï¼Œå¯åŠ¨æŒä»“ç®¡ç†
```

### 3.2 å¼€ä»“æ•°é‡è®¡ç®—

```python
def calculate_position_size(
    account_balance: float,      # è´¦æˆ·ä½™é¢
    position_pct: float,         # ä»“ä½ç™¾åˆ†æ¯” (å¦‚ 5 è¡¨ç¤º 5%)
    leverage: int,               # æ æ†å€æ•°
    entry_price: float,          # å…¥åœºä»·æ ¼
    symbol: str                  # äº¤æ˜“å¯¹
) -> float:
    """
    è®¡ç®—å¼€ä»“æ•°é‡
    
    ç¤ºä¾‹:
    - è´¦æˆ·ä½™é¢: 10,000 USDT
    - ä»“ä½ç™¾åˆ†æ¯”: 5%
    - æ æ†: 2x
    - å…¥åœºä»·: 42,850 USDT
    
    è®¡ç®—:
    - æŠ•å…¥æœ¬é‡‘ = 10,000 Ã— 5% = 500 USDT
    - æŒä»“ä»·å€¼ = 500 Ã— 2 = 1,000 USDT
    - å¼€ä»“æ•°é‡ = 1,000 / 42,850 = 0.0233 BTC
    """
    capital = account_balance * (position_pct / 100)
    position_value = capital * leverage
    quantity = position_value / entry_price
    
    # æ ¹æ®äº¤æ˜“å¯¹ç²¾åº¦å–æ•´
    quantity = round_to_precision(quantity, symbol)
    
    return quantity
```

### 3.3 é”™è¯¯å¤„ç†æœºåˆ¶

```python
# AIè°ƒç”¨è¶…æ—¶å¤„ç†
AI_TIMEOUT = 30  # ç§’

async def call_analyst_with_timeout(analyst, data):
    try:
        result = await asyncio.wait_for(
            analyst.analyze(data),
            timeout=AI_TIMEOUT
        )
        return result
    except asyncio.TimeoutError:
        logger.error(f"{analyst.name} è¶…æ—¶")
        return None

# å¹¶è¡Œè°ƒç”¨ - ä»»ä¸€è¶…æ—¶åˆ™å–æ¶ˆå¼€ä»“
async def parallel_analysis(data):
    results = await asyncio.gather(
        call_analyst_with_timeout(technical_analyst, data),
        call_analyst_with_timeout(sentiment_analyst, data),
        call_analyst_with_timeout(risk_analyst, data),
        return_exceptions=True
    )
    
    technical, sentiment, risk = results
    
    # ä»»ä¸€åˆ†æå¸ˆè¶…æ—¶/å¤±è´¥ï¼Œéƒ½ä¸å¼€ä»“
    if technical is None:
        logger.error("æŠ€æœ¯åˆ†æå¸ˆè¶…æ—¶ï¼Œå–æ¶ˆå¼€ä»“å†³ç­–")
        return None
    
    if sentiment is None:
        logger.error("æƒ…ç»ªåˆ†æå¸ˆè¶…æ—¶ï¼Œå–æ¶ˆå¼€ä»“å†³ç­–")
        return None
        
    if risk is None:
        logger.error("é£æ§å®˜è¶…æ—¶ï¼Œå–æ¶ˆå¼€ä»“å†³ç­–")
        return None
    
    return {"technical": technical, "sentiment": sentiment, "risk": risk}

# JSONè§£æ - ä½¿ç”¨ç»“æ„åŒ–è¾“å‡º
from pydantic import BaseModel
from typing import List, Optional

class TechnicalReport(BaseModel):
    analyst: str
    recommendation: dict
    # ... å…¶ä»–å­—æ®µ

def parse_ai_response(response: str, model_class: BaseModel):
    """
    ä½¿ç”¨Pydanticå¼ºåˆ¶æ ¡éªŒJSONç»“æ„
    æ¨èé…åˆ Anthropic/OpenAI çš„ JSON Mode ä½¿ç”¨
    """
    try:
        # æå–JSONéƒ¨åˆ†
        json_match = re.search(r'\{.*\}', response, re.DOTALL)
        if not json_match:
            raise ValueError("æœªæ‰¾åˆ°JSON")
        
        data = json.loads(json_match.group())
        return model_class(**data)  # Pydanticæ ¡éªŒ
    except Exception as e:
        logger.error(f"JSONè§£æå¤±è´¥: {e}")
        return None
```

### 3.4 ç¡¬é£æ§ï¼ˆä»£ç å±‚é¢ï¼Œä¸å¯è¢«AIç»•è¿‡ï¼‰

```python
"""
ç¡¬é£æ§è§„åˆ™ - å†™åœ¨ä»£ç é‡Œï¼ŒAIæ— æ³•ç»•è¿‡
è¿™äº›æ˜¯æœ€åä¸€é“é˜²çº¿ï¼Œé˜²æ­¢AIå¹»è§‰å¯¼è‡´ç¾éš¾æ€§æŸå¤±
"""

class HardRiskLimits:
    """ç¡¬æ€§é£æ§é™åˆ¶ - ä¸å¯ä¿®æ”¹"""
    
    # æ æ†é™åˆ¶
    MAX_LEVERAGE = 5                    # æœ€å¤§æ æ†ï¼Œæ— è®ºAIå»ºè®®å¤šå°‘
    
    # ä»“ä½é™åˆ¶
    MAX_POSITION_PCT = 10               # å•ç¬”æœ€å¤§ä»“ä½10%
    MAX_TOTAL_EXPOSURE_PCT = 30         # æ€»æ•å£ä¸è¶…è¿‡30%
    
    # äºæŸé™åˆ¶
    MAX_LOSS_PER_TRADE_PCT = 2          # å•ç¬”æœ€å¤§äºæŸ2%
    MAX_DAILY_LOSS_PCT = 5              # å•æ—¥æœ€å¤§äºæŸ5%
    MAX_WEEKLY_LOSS_PCT = 10            # å•å‘¨æœ€å¤§äºæŸ10%
    
    # é¢‘ç‡é™åˆ¶
    MAX_TRADES_PER_HOUR = 3             # æ¯å°æ—¶æœ€å¤šå¼€ä»“3æ¬¡
    MIN_TRADE_INTERVAL_SECONDS = 300    # ä¸¤ç¬”äº¤æ˜“æœ€å°é—´éš”5åˆ†é’Ÿ


def hard_risk_check(
    ai_decision: dict,
    account_state: dict,
    recent_trades: list
) -> tuple[bool, str, dict]:
    """
    ç¡¬é£æ§æ£€æŸ¥ - åœ¨æ‰§è¡Œå‰å¼ºåˆ¶æ ¡éªŒ
    è¿”å›: (æ˜¯å¦é€šè¿‡, æ‹’ç»åŸå› , è°ƒæ•´åçš„å‚æ•°)
    """
    
    leverage = ai_decision.get("leverage", 1)
    position_pct = ai_decision.get("position_pct", 0)
    
    adjusted = ai_decision.copy()
    warnings = []
    
    # 1. æ æ†æ£€æŸ¥
    if leverage > HardRiskLimits.MAX_LEVERAGE:
        adjusted["leverage"] = HardRiskLimits.MAX_LEVERAGE
        warnings.append(f"æ æ†ä»{leverage}xé™è‡³{HardRiskLimits.MAX_LEVERAGE}x")
    
    # 2. ä»“ä½æ£€æŸ¥
    if position_pct > HardRiskLimits.MAX_POSITION_PCT:
        adjusted["position_pct"] = HardRiskLimits.MAX_POSITION_PCT
        warnings.append(f"ä»“ä½ä»{position_pct}%é™è‡³{HardRiskLimits.MAX_POSITION_PCT}%")
    
    # 3. æ€»æ•å£æ£€æŸ¥
    current_exposure = account_state.get("total_exposure_pct", 0)
    if current_exposure + position_pct > HardRiskLimits.MAX_TOTAL_EXPOSURE_PCT:
        return False, f"æ€»æ•å£å°†è¶…è¿‡{HardRiskLimits.MAX_TOTAL_EXPOSURE_PCT}%é™åˆ¶", {}
    
    # 4. æ—¥äºæŸæ£€æŸ¥
    daily_pnl_pct = account_state.get("daily_pnl_pct", 0)
    if daily_pnl_pct <= -HardRiskLimits.MAX_DAILY_LOSS_PCT:
        return False, f"ä»Šæ—¥å·²äºæŸ{abs(daily_pnl_pct)}%ï¼Œè§¦å‘æ—¥äºæŸé™åˆ¶ï¼Œåœæ­¢äº¤æ˜“", {}
    
    # 5. å‘¨äºæŸæ£€æŸ¥
    weekly_pnl_pct = account_state.get("weekly_pnl_pct", 0)
    if weekly_pnl_pct <= -HardRiskLimits.MAX_WEEKLY_LOSS_PCT:
        return False, f"æœ¬å‘¨å·²äºæŸ{abs(weekly_pnl_pct)}%ï¼Œè§¦å‘å‘¨äºæŸé™åˆ¶ï¼Œåœæ­¢äº¤æ˜“", {}
    
    # 6. é¢‘ç‡æ£€æŸ¥
    recent_hour_trades = [t for t in recent_trades if t["time"] > time.time() - 3600]
    if len(recent_hour_trades) >= HardRiskLimits.MAX_TRADES_PER_HOUR:
        return False, "æœ¬å°æ—¶äº¤æ˜“æ¬¡æ•°å·²è¾¾ä¸Šé™", {}
    
    # 7. é—´éš”æ£€æŸ¥
    if recent_trades:
        last_trade_time = recent_trades[-1]["time"]
        if time.time() - last_trade_time < HardRiskLimits.MIN_TRADE_INTERVAL_SECONDS:
            return False, "è·ä¸Šç¬”äº¤æ˜“æ—¶é—´è¿‡çŸ­", {}
    
    if warnings:
        logger.warning(f"ç¡¬é£æ§è°ƒæ•´: {', '.join(warnings)}")
    
    return True, "", adjusted


# ä½¿ç”¨ç¤ºä¾‹
def execute_trade(ai_decision, account_state, recent_trades):
    """æ‰§è¡Œäº¤æ˜“å‰å¿…é¡»é€šè¿‡ç¡¬é£æ§"""
    
    passed, reason, adjusted = hard_risk_check(ai_decision, account_state, recent_trades)
    
    if not passed:
        logger.error(f"ç¡¬é£æ§æ‹’ç»: {reason}")
        return None
    
    # ä½¿ç”¨è°ƒæ•´åçš„å‚æ•°æ‰§è¡Œ
    return place_order(adjusted)
```

### 3.5 æŒä»“ç®¡ç†æµç¨‹

```
è§¦å‘æ¡ä»¶ï¼ˆæ»¡è¶³ä»»ä¸€å³å”¤é†’ï¼‰:
â”œâ”€â”€ å®šæ—¶: æ¯5åˆ†é’Ÿ
â”œâ”€â”€ ä»·æ ¼è§¦å‘: è¾¾åˆ°wake_up.price_above æˆ– price_below
â””â”€â”€ å¼ºåˆ¶: æ­¢ç›ˆ/æ­¢æŸè®¢å•æˆäº¤æ—¶

         â†“
1. è·å–æ´»è·ƒæŒä»“åˆ—è¡¨
         â†“
2. å¯¹æ¯ä¸ªæŒä»“:
   â””â”€â”€ prepare_position_summary()
       - åŒ…å«CTOå®Œæ•´æ€ç»´é“¾
       - åŒ…å«ç´¯è®¡äº¤æ˜“æˆæœ¬
       - åŒ…å«å½“å‰èµ„é‡‘è´¹ç‡
         â†“
3. è°ƒç”¨æŒä»“ç®¡ç†AI
         â†“
4. è§£æå†³ç­–JSON + æ ¡éªŒplansæ•°é‡
         â†“
5. æ‰§è¡Œæ“ä½œ
   â”œâ”€â”€ hold â†’ ç»§ç»­ç›‘æ§
   â”œâ”€â”€ adjust_sl_tp â†’ ä¿®æ”¹è®¢å•
   â”œâ”€â”€ reduce â†’ éƒ¨åˆ†å¹³ä»“ï¼ˆäº§ç”Ÿæ‰‹ç»­è´¹ï¼‰
   â”œâ”€â”€ add â†’ åŠ ä»“ï¼ˆäº§ç”Ÿæ‰‹ç»­è´¹ï¼‰
   â””â”€â”€ close â†’ å…¨éƒ¨å¹³ä»“ï¼ˆäº§ç”Ÿæ‰‹ç»­è´¹ï¼‰
         â†“
6. æ›´æ–°æŒä»“è®°å½• + ç´¯è®¡æˆæœ¬
         â†“
7. è®¾ç½®ä¸‹æ¬¡å”¤é†’æ¡ä»¶ï¼ˆwake_upï¼‰
         â†“
8. ç­‰å¾…è§¦å‘
```

```python
# Plansæ•°é‡æ ¡éªŒï¼ˆä»£ç å±‚é¢ï¼Œé˜²æ­¢AIè®¡ç®—é”™è¯¯ï¼‰
def validate_plans(plans: list, position_amount: float) -> bool:
    """
    æ ¡éªŒplansæ•°é‡ä¹‹å’Œæ˜¯å¦ç­‰äºæŒä»“æ•°é‡
    å¦‚æœä¸ç­‰ï¼Œè®°å½•è­¦å‘Šå¹¶è°ƒæ•´
    """
    total = sum(p["amount"] for p in plans)
    
    if abs(total - position_amount) > 0.001:  # å…è®¸å¾®å°è¯¯å·®
        logger.warning(f"Plansæ•°é‡ä¸åŒ¹é…: plansæ€»é‡={total}, æŒä»“={position_amount}")
        # è‡ªåŠ¨è°ƒæ•´æœ€åä¸€ä¸ªplançš„æ•°é‡
        diff = position_amount - total
        plans[-1]["amount"] += diff
        logger.info(f"è‡ªåŠ¨è°ƒæ•´æœ€åä¸€ä¸ªplan: {plans[-1]}")
    
    return True

# ä»·æ ¼è§¦å‘å”¤é†’
class PriceWatcher:
    def __init__(self):
        self.wake_conditions = {}  # position_id -> wake_up
    
    def set_wake_up(self, position_id: str, wake_up: dict):
        self.wake_conditions[position_id] = wake_up
    
    def check_price(self, position_id: str, current_price: float) -> bool:
        """æ£€æŸ¥æ˜¯å¦éœ€è¦å”¤é†’"""
        wake = self.wake_conditions.get(position_id)
        if not wake:
            return False
        
        if current_price >= wake.get("price_above", float('inf')):
            logger.info(f"ä»·æ ¼ä¸Šç ´ {wake['price_above']}ï¼Œå”¤é†’æŒä»“ç®¡ç†AI")
            return True
        
        if current_price <= wake.get("price_below", 0):
            logger.info(f"ä»·æ ¼ä¸‹ç ´ {wake['price_below']}ï¼Œå”¤é†’æŒä»“ç®¡ç†AI")
            return True
        
        return False
```

### 3.5 å¤šäº¤æ˜“å¯¹æ”¯æŒ

ç³»ç»Ÿæ”¯æŒå¤šä¸ªäº¤æ˜“å¯¹ï¼Œæ¯ä¸ªäº¤æ˜“å¯¹æœ‰ç‹¬ç«‹çš„é…ç½®ï¼š

```python
SUPPORTED_SYMBOLS = {
    "BTCUSDT": {
        "name": "æ¯”ç‰¹å¸",
        "min_qty": 0.001,
        "qty_precision": 3,      # æ•°é‡ç²¾åº¦ï¼š0.001
        "price_precision": 1,    # ä»·æ ¼ç²¾åº¦ï¼š0.1
        "min_notional": 5,       # æœ€å°åä¹‰ä»·å€¼ï¼š5 USDT
        "max_leverage": 20,
        "default_leverage": 3
    },
    "ETHUSDT": {
        "name": "ä»¥å¤ªåŠ",
        "min_qty": 0.01,
        "qty_precision": 2,
        "price_precision": 2,
        "min_notional": 5,
        "max_leverage": 20,
        "default_leverage": 3
    },
    "SOLUSDT": {
        "name": "Solana",
        "min_qty": 0.1,
        "qty_precision": 1,
        "price_precision": 3,
        "min_notional": 5,
        "max_leverage": 15,
        "default_leverage": 2
    }
}

def get_symbol_config(symbol: str) -> dict:
    """è·å–äº¤æ˜“å¯¹é…ç½®"""
    if symbol not in SUPPORTED_SYMBOLS:
        raise ValueError(f"ä¸æ”¯æŒçš„äº¤æ˜“å¯¹: {symbol}")
    return SUPPORTED_SYMBOLS[symbol]

def round_to_precision(quantity: float, symbol: str) -> float:
    """æ ¹æ®äº¤æ˜“å¯¹ç²¾åº¦å–æ•´"""
    config = get_symbol_config(symbol)
    precision = config["qty_precision"]
    return round(quantity, precision)
```

---

## å››ã€é™„å½•ï¼šåˆ¤æ–­åŸºå‡†é€ŸæŸ¥è¡¨

### ææƒ§è´ªå©ªæŒ‡æ•°
| åŒºé—´ | çŠ¶æ€ | æ“ä½œå»ºè®® |
|------|------|----------|
| 0-20 | æåº¦ææƒ§ | é€†å‘çœ‹å¤š |
| 20-40 | ææƒ§ | è°¨æ…çœ‹å¤š |
| 40-60 | ä¸­æ€§ | é¡ºåŠ¿æ“ä½œ |
| 60-80 | è´ªå©ª | é¡ºåŠ¿ä½†æ§ä»“ |
| 80-100 | æåº¦è´ªå©ª | é€†å‘çœ‹ç©º |

### èµ„é‡‘è´¹ç‡
| åŒºé—´ | çŠ¶æ€ | æ“ä½œå»ºè®® |
|------|------|----------|
| < -0.03% | æåº¦ç©ºå¤´ | é€†å‘çœ‹å¤š |
| -0.03% ~ -0.01% | åç©º | æ³¨æ„åå¼¹ |
| -0.01% ~ 0.01% | ä¸­æ€§ | æ­£å¸¸æ“ä½œ |
| 0.01% ~ 0.03% | åå¤š | æ³¨æ„å›è°ƒ |
| > 0.03% | æåº¦å¤šå¤´ | é€†å‘çœ‹ç©º |

### ADXè¶‹åŠ¿å¼ºåº¦
| å€¼ | çŠ¶æ€ | æ“ä½œå»ºè®® |
|----|------|----------|
| < 20 | éœ‡è¡ | åŒºé—´äº¤æ˜“ |
| 20-25 | å¼±è¶‹åŠ¿ | è°¨æ…è¿½è¶‹åŠ¿ |
| 25-50 | æœ‰æ•ˆè¶‹åŠ¿ | é¡ºåŠ¿æ“ä½œ |
| > 50 | å¼ºè¶‹åŠ¿ | è¶‹åŠ¿æœ«æœŸè­¦æƒ• |

### RSIçŠ¶æ€
| å€¼ | çŠ¶æ€ | æ“ä½œå»ºè®® |
|----|------|----------|
| < 30 | è¶…å– | å…³æ³¨åå¼¹ |
| 30-50 | åå¼± | è°¨æ…åšå¤š |
| 50-70 | å¥åº· | æ­£å¸¸æ“ä½œ |
| > 70 | è¶…ä¹° | å…³æ³¨å›è°ƒ |

### æ³¢åŠ¨ç‡(ATR%)
| å€¼ | çŠ¶æ€ | æ æ†å»ºè®® |
|----|------|----------|
| < 0.5% | ä½æ³¢åŠ¨ | å¯æé«˜æ æ† |
| 0.5-1.5% | æ­£å¸¸ | æ ‡å‡†æ æ† |
| 1.5-3.0% | é«˜æ³¢åŠ¨ | é™ä½æ æ† |
| > 3.0% | æç«¯ | æœ€ä½æ æ†æˆ–è§‚æœ› |

### æŒä»“ç®¡ç†åŸåˆ™
| ç›ˆåˆ©æ°´å¹³ | æ­¢æŸè°ƒæ•´ | æ­¢ç›ˆç­–ç•¥ |
|----------|----------|----------|
| < 1% | ä¿æŒåŸæ­¢æŸ | ç­‰å¾… |
| 1-2% | å¯ç§»è‡³ä¿æœ¬ | ç­‰å¾… |
| 2-3% | è‡³å°‘ä¿æŠ¤0.5% | è€ƒè™‘éƒ¨åˆ†æ­¢ç›ˆ |
| > 3% | å¯ç”¨è¿½è¸ªæ­¢æŸ | åˆ†æ‰¹æ­¢ç›ˆ |

---

*æ–‡æ¡£ç‰ˆæœ¬: v4.1*  
*æ›´æ–°æ—¥æœŸ: 2024å¹´*  
*æ ¸å¿ƒæ”¹è¿›:*
- *ç²¾ç®€AIè¾“å…¥æ•°æ®ï¼ˆåˆ é™¤åˆ¤æ–­åŸºå‡†è¡¨ã€å†å²å¯¹æ¯”æ•°æ®ï¼‰*
- *ç²¾ç®€AIè¾“å‡ºç»“æ„ï¼ˆæ‰å¹³åŒ–JSONï¼‰*
- *å¢å¼ºé¦–å¸­äº¤æ˜“å®˜å¤šå‘¨æœŸæ¡†æ¶ï¼ˆ15m/4h/1dï¼‰*
- *æŒä»“ç®¡ç†AIç¬¬ä¸€äººç§°æ€è€ƒè¾“å‡º*
- *æ·»åŠ é”™è¯¯å¤„ç†æœºåˆ¶å’Œå¼€ä»“æ•°é‡è®¡ç®—*
- *æ·»åŠ å¤šäº¤æ˜“å¯¹æ”¯æŒ*
- *é£æ§å®˜æ·»åŠ 7å¤©å†å²äº¤æ˜“è®°å½•*